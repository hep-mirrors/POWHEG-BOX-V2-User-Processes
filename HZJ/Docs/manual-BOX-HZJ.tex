\documentclass[paper]{JHEP3}
\usepackage{amsmath,amssymb,enumerate,url}
\bibliographystyle{JHEP}

%%%%%%%%%% Start TeXmacs macros
\newcommand{\tmtextit}[1]{{\itshape{#1}}}
\newcommand{\tmtexttt}[1]{{\ttfamily{#1}}}
\newenvironment{enumeratenumeric}{\begin{enumerate}[1.] }{\end{enumerate}}
\newcommand\sss{\mathchoice%
{\displaystyle}%
{\scriptstyle}%
{\scriptscriptstyle}%
{\scriptscriptstyle}%
}

\newcommand\as{\alpha_{\sss\rm S}}
\newcommand\POWHEG{{\tt POWHEG}}
\newcommand\POWHEGBOX{{\tt POWHEG BOX}}
\newcommand\POWHEGBOXV{{\tt POWHEG-BOX-V2}}
\newcommand\HERWIG{{\tt HERWIG}}
\newcommand\PYTHIA{{\tt PYTHIA}}
\newcommand\MCatNLO{{\tt MC@NLO}}
\newcommand\HZJ{{\tt HZJ}}

\newcommand\kt{k_{\sss\rm T}}

\newcommand\pt{p_{\sss\rm T}}
\newcommand\LambdaQCD{\Lambda_{\scriptscriptstyle QCD}}
%%%%%%%%%% End TeXmacs macros


\title{The POWHEG BOX V2 user manual:\\
  associated production of a Higgs boson with a $\boldsymbol{Z}$ boson plus a jet} \vfill
\author{Federico Granata\\
  Universit\`a di Milano-Bicocca and INFN, Sezione di Milano-Bicocca\\
  Piazza della Scienza 3, 20126 Milano, Italy\\
  E-mail: \email{federico.granata@mib.infn.it}}

\author{Gionata Luisoni\\ 
  Max-Planck Institut f{\"u}r Physik, F\"ohringer 6, D-80805 Munich, Germany\\
  E-mail: \email{luisonig@mpp.mpg.de}
}
\author{Paolo Nason\\
  INFN, Sezione di Milano Bicocca, Piazza della Scienza 3, 20126 Milano, Italy\\
  E-mail: \email{paolo.nason@mib.infn.it}
}

\author{Carlo Oleari\\
  Universit\`a di Milano-Bicocca and INFN, Sezione di Milano-Bicocca\\
  Piazza della Scienza 3, 20126 Milano, Italy\\
  E-mail: \email{carlo.oleari@mib.infn.it}}

\author{Francesco Tramontano\\
  Universit\`a di Napoli ``Federico II'' and INFN, Sezione di Napoli,\\
  Complesso di Monte Sant'Angelo, via Cintia, 80126 Napoli, Italy\\
  E-mail: \email{francesco.tramontano@na.infn.it}
}
\vskip -0.5truecm

\keywords{POWHEG, Shower Monte Carlo, NLO}

\abstract{This note documents the use of the package \POWHEGBOXV{}
  for the associated production of a Higgs boson with a $Z$ boson plus a jet.
  Results can be easily interfaced to shower Monte Carlo programs, in such a
  way that both NLO and shower accuracy are maintained.}  \preprint{\today\\
  {\tt POWHEG BOX V2} 1.0}

\begin{document}


\section{Introduction}

The \POWHEGBOX{} program is a framework for implementing NLO calculations in
shower Monte Carlo programs according to the \POWHEG{} method. An explanation
of the method and a discussion of how the code is organized can be found in
refs.~\cite{Nason:2004rx,Frixione:2007vw,Alioli:2010xd}.  The code is
distributed according to the ``MCNET GUIDELINES for Event Generator Authors
and Users'' and can be found at the web page
%
\begin{center}
 \url{http://powhegbox.mib.infn.it}
\end{center}
%
In this manual, we describe the \POWHEG{} implementation of the
associated production of a Higgs boson with a $Z$ boson and a jet, as
described in ref.~\cite{Luisoni:2013cuh}, together with some new
features.

The code can be found in the \HZJ{} directory under {\tt
  User-Processes-V2}, and can be used to generate NLO+PS QCD
corrections to $HZj$ production at hadronic colliders.  The $Z$ boson
is allowed to decay leptonically, hadronically, in both of them (inclusive
decay), inclusively in leptons or in neutrinos.  In case of hadronic
and inclusive decay, the NLO corrections to the decay quarks are not
included in the POWHEG Monte Carlo simulation, but the NLO corrections
to the decay products are taken into account by multiplying the
respective tree-level hadronic widths by an overall factor
$1+\as(m_{\sss Z})/\pi$.

Virtual loop-induced massive bottom and top corrections are fully included,
with the possibility to switch them off or on separately.  Anomalous
couplings of the Higgs boson to the bottom and top quarks and to the $Z$
boson are taken into account through a multiplicative factor.

This document describes the input parameters that are specific to this
implementation. The parameters that are common to all \POWHEGBOX{}
implementation can be found in the manual in the \POWHEGBOXV{}/{\tt Docs}
directory.




\section{New added features}

\begin{enumerate}
\item An analytic form of the virtual corrections has been implemented
  recently and has replaced the previous numeric code, generated using the
  {\tt GoSam} package~\cite{Cullen:2011ac}. The numeric code is still
  available in the repository\footnote{If the user wants to use virtual
    corrections generated by {\tt Gosam}, the parameter {\tt whichprogram} in
    the file {\tt virtual.f} has to be adjusted: with {\tt whichprogram = 1},
    the {\tt GoSam} amplitudes are used, with {\tt whichprogram = 2} (the
    default value), the analytic amplitudes are computed, and by setting {\tt
      whichprogram = 3} both amplitudes are evaluated and the ratio of the
    two amplitudes is printed if they differ by more than a part over
    $10^5$. This last option can be used for debugging.}.

   With the new analytic virtual amplitudes, it is now possible to include
   the contribution of massive top and bottom quarks.

\item We have added the possibility to decay the $Z$ boson hadronically and
  inclusively, in addition to the leptonic decay originally implemented.

\item The code can now deal with anomalous couplings of the Higgs
  boson with the bottom and top quarks and with the $Z$ boson.

\end{enumerate}

All the new features will be described in more detail in a forthcoming
paper~\cite{toappear}.




\section{Generation of events}

According to the \POWHEGBOXV{} manual, it is possible to split a \POWHEG{}
run into several parallel ones.  See \POWHEGBOXV{}/{\tt Docs/V2-paper.pdf}
for a detailed discussion. Here we briefly recall how it works.

A template input file ({\tt powheg.input-save}) can be found under {\tt
  HZJ/testrun-lhc} directory. The following flags have to be activated

\noindent
{\tt manyseeds 1 \qquad \quad \,\,\,! get the
  seeds for the random number generator from 
\\ \# \qquad \qquad \qquad
  \qquad \qquad pwgseeds.dat
\\ parallelstage <x> \,\,\,! <x>=1...4, which
  level of parallel stage
\\ xgriditeration <y> ! <y> is the iteration level
  for the calculation of the \# \qquad \qquad \qquad \qquad \qquad importance
  sampling grid improvement (relevant only 
\\ \# \qquad \qquad \qquad \qquad
  \qquad for parallelstage=1)}

\noindent
The file {\tt pwgseeds.dat} in the directory {\tt testrun-lhc}
contains a list of integer seeds, one per line. When the program starts, it
asks for an integer number $m$. This number is used to select a line in the
{\tt pwgseeds.dat} file, and the integer found there is used to
initialize the random number generator. In this way, several runs can be
performed simultaneously in the same directory, all using different random
number seeds. Furthermore, the integer $m$ appears as a four digit integer
(with leading zeros) in the name of all files that are generated by the
corresponding run.

The generation of events is done by the \POWHEGBOXV{} in four stages. An
example of script file to drive the runs can be found in {\tt
  testrun-lhc/run.sh}.  The user has to set the number of cores she/he wants
to use ({\tt ncores}) and the number {\tt xgriditeration} for the first
stage. All the other parameters are set in the {\tt powheg.input-save} file,
that is copied into the {{\tt powheg.input} at each stage by the {\tt run.sh}
  script.

Other useful scripts can be found in the {\tt HZJ} directory:
\begin{itemize}
\item {\tt runNLO.sh}: to combine the NLO partial results of the parallel
  runs into a unique file

\item {\tt runLHEF.sh}: to run the analysis in the {\tt
  pwhg\_analysis-HZnJ.f} on the LHE events

\item {\tt runpy.sh}: to run {\tt Pythia} on the event files

\item {\tt runrwgt.sh}: to run the reweighting procedure on the event files

\end{itemize}




\section{Process-specific input parameters}

\noindent The $Z$ boson can decay into leptons or hadrons,
but also the inclusive decay modes have been implemented.  In the
hadronic mode, the $Z$ boson is allowed to decay into the following:
$Z \to \{ d\bar{d}, u\bar{u}, s\bar{s}, c\bar{c}, b\bar{b} \}$. No
decay into top quark allowed.  In the inclusive decay, the $Z$ boson
can decay both hadronically and leptonically, i.e.~$Z \to \{e^- e^+,\,
\mu^- \mu^+,\, \tau^- \tau^+, \,
\nu_e\bar{\nu}_e,\, \nu_\mu\bar{\nu}_\mu, \,\nu_\tau\bar{\nu}_\tau\}$. 
In the inclusive leptonic decay all the charged leptonic decays are allowed,
while in the inclusive neutrino decay the $Z$ boson can decay into $\{
\nu_e\bar{\nu}_e,\, \nu_\mu\bar{\nu}_\mu, \,\nu_\tau\bar{\nu}_\tau\}$.
 The
decay mode of the $Z$ boson is set by the parameter {\tt
  vdecaymode}:\\
\noindent \tmtexttt{vdecaymode \,\, 1 \quad\, ! 1: e, \quad \quad\,\,2: mu,
  \quad \quad\,\,3:  tau,\\
\# \qquad \qquad \qquad \qquad \quad\,\,\,4:  nu\_e, \quad 5:  nu\_mu, \quad 6:
nu\_tau,\\ 
\# \qquad \qquad \qquad \qquad \quad\,\,\,0:  had, \quad 10: inc, \,\quad 11:
inc lep, \quad 12: inc neu}\\  

\noindent In the inclusive decay modes, the user has the possibility to
neglect $Z \to \tau^-\tau^+$ decay by setting the parameter {\tt nleptfam} in
the file {\tt init\_couplings.f} to 2. By default this parameter is set to 3,
so that all the three lepton families are considered.\\

\noindent The inclusion of the virtual massive top and/or bottom quark loops
is controlled by the following parameters:\\
\noindent {\tt massivetop \qquad 1 \qquad ! 1: include top quark loops; 0 otherwise}\\
\noindent {\tt massivebottom   \,\,\,1 \qquad ! 1: include bottom quark
  loops; 0 otherwise}\\
%
If {\tt massivebottom} is set to 1, the bottom quarks are considered massive
only in the virtual loops. The rest of the program considers them as
massless. The masses of these quarks can be set with the {\tt tmass} and
{\tt bmass} parameters in the input file.\\


\noindent The Higgs boson couplings to the $Z$ boson, the top and the bottom
quark can be multiplicatively varied through kappa-parameters: {\tt
  kappa\_ghz}, {\tt kappa\_ght} and {\tt kappa\_ghb} in the input file. Their
default value is 1. Each of these factors multiplies the corresponding Higgs
vertex in the Feynman diagram, so that, for example, the Born amplitude is
multiplied by {\tt kappa\_ghz**2}. \\

\noindent The last step performed by the \POWHEGBOXV{} before writing a
generated event on a Les Houches file, is to perform the reshuffling of the
momenta of the final-state particles, in order to give masses to them. The
user can set these masses in the {\tt init\_couplings.f} file, by changing
{\tt physpar\_mq}, for the quarks, and {\tt physpar\_ml}, for the charged
leptons.


\begin{thebibliography}{10}

\bibitem{Nason:2004rx}
  P.~Nason,
  ``A new method for combining NLO QCD with shower Monte Carlo algorithms,''
  JHEP {\bf 0411} (2004) 040
  [arXiv:hep-ph/0409146].
  %%CITATION = JHEPA,0411,040;%%

%\cite{Frixione:2007vw}
\bibitem{Frixione:2007vw}
  S.~Frixione, P.~Nason and C.~Oleari,
``Matching NLO QCD computations with Parton Shower simulations: the POWHEG
method,''
  JHEP {\bf 0711} (2007) 070
  [arXiv:0709.2092 [hep-ph]].
  %%CITATION = JHEPA,0711,070;%%

%\cite{Alioli:2010xd}
\bibitem{Alioli:2010xd}
  S.~Alioli, P.~Nason, C.~Oleari and E.~Re,
``A general framework for implementing NLO calculations in shower Monte Carlo
  programs: the POWHEG BOX,''
  [arXiv:1002.2581 [hep-ph]].
  %%CITATION = ARXIV:1002.2581;%%

%\cite{Luisoni:2013cuh}
\bibitem{Luisoni:2013cuh}
  G.~Luisoni, P.~Nason, C.~Oleari and F.~Tramontano,
  ``$HW^{\pm}$/HZ + 0 and 1 jet at NLO with the POWHEG BOX interfaced to GoSam and their merging within MiNLO,''
  JHEP {\bf 1310} (2013) 083
  [arXiv:1306.2542 [hep-ph]].
  %%CITATION = ARXIV:1306.2542;%%

%\cite{Cullen:2011ac}
\bibitem{Cullen:2011ac}
  G.~Cullen, N.~Greiner, G.~Heinrich, G.~Luisoni, P.~Mastrolia, G.~Ossola, T.~Reiter and F.~Tramontano,
  ``Automated One-Loop Calculations with GoSam,''
  Eur.\ Phys.\ J.\ C {\bf 72} (2012) 1889
  [arXiv:1111.2034 [hep-ph]].
  %%CITATION = ARXIV:1111.2034;%%


\bibitem{toappear}
F.~Granata and C.~Oleari. To appear soon.

\end{thebibliography}

\end{document}





