c
c in this file leptonic tensors needed for qq -> qq ZZ, ZZ -> 2l 2v 
c and ZZ -> 4l are computed for specific helicities (h) and with anomalous 
c EW couplings
c	

c============================================================

      subroutine wwtozzn(q1,q2,P,h,ww_munu,ttype)
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  53) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  14) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer lsign(3:6)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
C GLOBAL VARIABLES
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                          
C  
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0

      ie = sign(1,2-h)
      iu = -1
     
      
      
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	 
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   )) !vm 
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   )) !vm~ 
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            CALL VVV1_10_3_5_6_7_9_3(W(1,1),W(1,2),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MZ,WZ,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,8))
      CALL FFV2_1(W(1,5),W(1,7),GC_74,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV2_0(W(1,6),W(1,9),W(1,8),GC_74,AMP(1))
      CALL FFV2_2(W(1,6),W(1,7),GC_74,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 2
      CALL FFV2_0(W(1,9),W(1,5),W(1,8),GC_74,AMP(2))
      CALL VVV7_3(W(1,1),W(1,2),GC_7,MZ,WZ,W(1,9))
      CALL FFV2_1(W(1,5),W(1,9),GC_74,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 3
      CALL FFV2_0(W(1,6),W(1,10),W(1,8),GC_74,AMP(3))
      CALL FFV2_2(W(1,6),W(1,9),GC_74,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 4
      CALL FFV2_0(W(1,10),W(1,5),W(1,8),GC_74,AMP(4))
      CALL VVS6_3(W(1,1),W(1,2),GC_96,MH,WH,W(1,10))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,11))
      CALL FFV2_3(W(1,6),W(1,5),GC_74,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 5
      CALL VVS1_3_4_7_8_9_0(W(1,11),W(1,12),W(1,10),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL VVS6_0(W(1,8),W(1,12),W(1,10),GC_118,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL VVS5_9_0(W(1,8),W(1,12),W(1,10),GC_115,GC_119,AMP(7))
      CALL VVS2_9_3(W(1,1),W(1,2),GC_88,GC_88,MH,WH,W(1,10))
C     Amplitude(s) for diagram number 8
      CALL VVS6_0(W(1,8),W(1,12),W(1,10),GC_118,AMP(8))
      CALL VVV10_2_3_4_7_8_9P0_1(W(1,1),W(1,2),GC_55,GC_105,GC_114
     $ ,GC_104,GC_114,GC_104,GC_57,ZERO,ZERO,W(1,10))
      CALL FFV1_2(W(1,3),W(1,10),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,12),GC_43,GC_46,AMP(9))
      CALL FFV1_1(W(1,4),W(1,10),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,3),W(1,13),W(1,12),GC_43,GC_46,AMP(10))
      CALL VVV7P0_1(W(1,1),W(1,2),GC_47,ZERO,ZERO,W(1,13))
      CALL FFV1_2(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,10),W(1,4),W(1,12),GC_43,GC_46,AMP(11))
      CALL FFV1_1(W(1,4),W(1,13),GC_3,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,12),GC_43,GC_46,AMP(12))
      CALL FFV2_4_2(W(1,3),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,10),W(1,4),W(1,12),GC_43,GC_46,AMP(13))
      CALL FFV2_4_1(W(1,4),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 14
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,12),GC_43,GC_46,AMP(14))
      CALL FFV2_4_2(W(1,3),W(1,9),GC_43,GC_46,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 15
      CALL FFV2_4_0(W(1,10),W(1,4),W(1,12),GC_43,GC_46,AMP(15))
      CALL FFV2_4_1(W(1,4),W(1,9),GC_43,GC_46,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,12),GC_43,GC_46,AMP(16))
      CALL FFV2_2(W(1,3),W(1,1),GC_42,ZERO,ZERO,W(1,10))
      CALL FFV2_1(W(1,4),W(1,2),GC_42,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 17
      CALL FFV2_0(W(1,10),W(1,9),W(1,12),GC_74,AMP(17))
      CALL FFV2_2(W(1,6),W(1,2),GC_42,ZERO,ZERO,W(1,7))
      CALL FFV2_3(W(1,10),W(1,4),GC_42,MW,WW,W(1,13))
C     Amplitude(s) for diagram number 18
      CALL FFV2_0(W(1,7),W(1,5),W(1,13),GC_42,AMP(18))
      CALL FFV2_2(W(1,10),W(1,2),GC_42,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,12),GC_43,GC_46,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL VVV1_10_3_5_6_7_9_0(W(1,13),W(1,2),W(1,12),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL VVV7_0(W(1,13),W(1,2),W(1,12),GC_7,AMP(21))
      CALL FFV2_1(W(1,5),W(1,1),GC_42,ZERO,ZERO,W(1,13))
      CALL FFV2_3(W(1,6),W(1,13),GC_42,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 22
      CALL FFV2_0(W(1,3),W(1,9),W(1,14),GC_42,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,7),W(1,13),W(1,11),GC_3,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,8),GC_43,GC_46,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL VVV10_2_3_4_7_8_9_0(W(1,11),W(1,14),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(25))
C     Amplitude(s) for diagram number 26
      CALL VVV7_0(W(1,11),W(1,14),W(1,2),GC_47,AMP(26))
      CALL FFV2_1(W(1,13),W(1,2),GC_42,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 27
      CALL FFV2_0(W(1,6),W(1,4),W(1,8),GC_74,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL VVV1_10_3_5_6_7_9_0(W(1,14),W(1,2),W(1,8),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL VVV7_0(W(1,14),W(1,2),W(1,8),GC_7,AMP(29))
      CALL FFV2_1(W(1,9),W(1,1),GC_42,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 30
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,12),GC_43,GC_46,AMP(30))
      CALL VVV1_10_3_5_6_7_9_2(W(1,1),W(1,12),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 31
      CALL FFV2_0(W(1,3),W(1,9),W(1,14),GC_42,AMP(31))
      CALL VVV7_2(W(1,1),W(1,12),GC_7,MW,WW,W(1,4))
C     Amplitude(s) for diagram number 32
      CALL FFV2_0(W(1,3),W(1,9),W(1,4),GC_42,AMP(32))
      CALL VVV10_2_3_4_7_8_9_3(W(1,11),W(1,1),GC_55,GC_105,GC_114
     $ ,GC_104,GC_114,GC_104,GC_57,MW,WW,W(1,9))
C     Amplitude(s) for diagram number 33
      CALL FFV2_0(W(1,7),W(1,5),W(1,9),GC_42,AMP(33))
      CALL VVV7_3(W(1,11),W(1,1),GC_47,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 34
      CALL FFV2_0(W(1,7),W(1,5),W(1,3),GC_42,AMP(34))
      CALL FFV2_2(W(1,7),W(1,1),GC_42,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 35
      CALL FFV2_0(W(1,6),W(1,5),W(1,8),GC_74,AMP(35))
      CALL VVV1_10_3_5_6_7_9_2(W(1,1),W(1,8),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MW,WW,W(1,6))
C     Amplitude(s) for diagram number 36
      CALL FFV2_0(W(1,7),W(1,5),W(1,6),GC_42,AMP(36))
      CALL VVV7_2(W(1,1),W(1,8),GC_7,MW,WW,W(1,13))
C     Amplitude(s) for diagram number 37
      CALL FFV2_0(W(1,7),W(1,5),W(1,13),GC_42,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL VVVV7_0(W(1,11),W(1,1),W(1,2),W(1,12),GC_49,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL VVVV3_7_8_0(W(1,11),W(1,1),W(1,2),W(1,12),GC_58,GC_127
     $ ,GC_59,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL VVV7_0(W(1,9),W(1,2),W(1,12),GC_7,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL VVV1_10_3_5_6_7_9_0(W(1,3),W(1,2),W(1,12),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(41))
C     Amplitude(s) for diagram number 42
      CALL VVV7_0(W(1,3),W(1,2),W(1,12),GC_7,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL VVV7_0(W(1,11),W(1,14),W(1,2),GC_47,AMP(43))
C     Amplitude(s) for diagram number 44
      CALL VVV10_2_3_4_7_8_9_0(W(1,11),W(1,4),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL VVV7_0(W(1,11),W(1,4),W(1,2),GC_47,AMP(45))
C     Amplitude(s) for diagram number 46
      CALL VVVV4_0(W(1,1),W(1,2),W(1,8),W(1,12),GC_12,AMP(46))
C     Amplitude(s) for diagram number 47
      CALL VVVV2_4_9_0(W(1,1),W(1,2),W(1,8),W(1,12),GC_22,GC_126,GC_25
     $ ,AMP(47))
C     Amplitude(s) for diagram number 48
      CALL VVV7_0(W(1,6),W(1,2),W(1,12),GC_7,AMP(48))
C     Amplitude(s) for diagram number 49
      CALL VVV1_10_3_5_6_7_9_0(W(1,13),W(1,2),W(1,12),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(49))
C     Amplitude(s) for diagram number 50
      CALL VVV7_0(W(1,13),W(1,2),W(1,12),GC_7,AMP(50))
C     Amplitude(s) for diagram number 51
      CALL VVV7_0(W(1,14),W(1,2),W(1,8),GC_7,AMP(51))
C     Amplitude(s) for diagram number 52
      CALL VVV1_10_3_5_6_7_9_0(W(1,4),W(1,2),W(1,8),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(52))
C     Amplitude(s) for diagram number 53
      CALL VVV7_0(W(1,4),W(1,2),W(1,8),GC_7,AMP(53))
               
            if(higgs_only) then
               
               ww_munu(mu,nu) = -amp(5)-amp(6)-amp(7)-amp(8) !H->ZZ  graph only
               
            else          
               ww_munu(mu,nu) = -AMP(1)-AMP(2)-AMP(3)-AMP(4)-AMP(5)
     $              -AMP(9)-AMP(10)-AMP(11)-AMP(12)-AMP(13)-AMP(14)-AMP(15)-AMP(16)
     $              -AMP(17)-AMP(18)-AMP(19)-AMP(20)-AMP(21)-AMP(22)-AMP(23)
     $              -AMP(24)-AMP(25)-AMP(26)-AMP(27)-AMP(28)-AMP(29)-AMP(30)
     $              -AMP(31)-AMP(32)-AMP(33)-AMP(34)-AMP(35)-AMP(36)-AMP(37)
     $              -AMP(38)-AMP(39)-AMP(40)-AMP(41)-AMP(42)-AMP(43)-AMP(44)
     $              -AMP(45)-AMP(46)-AMP(47)-AMP(48)-AMP(49)-AMP(50)-AMP(51)
     $              -AMP(52)-AMP(53)-AMP(6)-AMP(7)-AMP(8)
               
            endif
            
         ENDDO
      ENDDO
      
      END
      
c     ------------------------------------------------------------	
      
      subroutine WWtoLLN(idb,h,Q,v,wll,ttype)
C     Input:   Q(*)        one of the two incoming boson momenta 
c     idb = 1      Q = q1 = W+ momentum
c     idb = 2      Q = q2 = W- momentum
c     OUPTPUT: wll(mu,nu)  lepton tensor for w w--> vm vm~ 
C     
C     
C     Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C     RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C     FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C     
C     FOR PROCESS : w+ w- -> vm vm~  
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C     
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wll(0:3,0:3)
      integer h,iu
      integer ttype
C     
C     LOCAL VARIABLES 
C     
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c     lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lup_loc(6),lum_loc(6)
      double precision qu_loc(0:4)
C     
C     
C     GLOBAL VARIABLES
C     
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                            
C ----------
C BEGIN CODE
C ----------
c
        if (ttype.eq.1) then
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)
           qu_loc(:) = qu_born(:)
        elseif (ttype.eq.3) then
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    q2(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      endif
             
      DO MU = 0,3
         DO NU = 0,3
            CALL OXXXXX_5(P(0,3   ),ZERO ,-1,+1,W(1,3   ))	 
            CALL IXXXXX_5(P(0,4   ),ZERO ,+1,-1,W(1,4   )) 
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   ))

            CALL VVV1_10_3_5_6_7_9_3(W(1,1),W(1,2),GC_112,GC_18,GC_108
     $           ,GC_112,GC_110,GC_108,GC_20,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_0(W(1,4),W(1,3),W(1,5),GC_74,AMP(1))
            CALL VVV7_3(W(1,1),W(1,2),GC_7,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_0(W(1,4),W(1,3),W(1,5),GC_74,AMP(2))
            CALL FFV2_1(W(1,3),W(1,1),GC_42,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,4),W(1,5),W(1,2),GC_42,AMP(3))
            
            wll(mu,nu) = -AMP(1)-AMP(2)-AMP(3)
	 enddo                  !nu
      enddo                     !mu
      end
      
c ------------------------------------------------------------	

      subroutine vto4ln(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer ttype,h

	call Zto4ln(P,h,z4l,ttype)
	call Ato4ln(P,h,a4l,ttype)	
     	end
		
c ------------------------------------------------------------	
c ------------------------------------------------------------	
   
      subroutine Zto4LN(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   4) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"

c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6) 
  
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = -1

 
       do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo


      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,-ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,+ie,+1,W(1,3   ))       
         CALL OXXXXX_5(P(0,4   ),ZERO ,+iu,+1,W(1,4   ))       
         CALL IXXXXX_5(P(0,5   ),ZERO ,-iu,-1,W(1,5   )) 
         CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))

          CALL FFV2_4_3(W(1,2),W(1,3),GC_43,GC_46,MZ,WZ,W(1,6))
      CALL FFV2_1(W(1,4),W(1,6),GC_74,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
      CALL FFV2_0(W(1,5),W(1,7),W(1,1),GC_74,AMP(1))
      CALL FFV2_2(W(1,5),W(1,6),GC_74,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
      CALL FFV2_0(W(1,7),W(1,4),W(1,1),GC_74,AMP(2))
      CALL FFV2_3(W(1,5),W(1,4),GC_74,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,2),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_43,GC_46,AMP(3))
      CALL FFV2_4_1(W(1,3),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_43,GC_46,AMP(4))
         z(  mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)
      enddo
      
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))
      
      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4LN(P,h,a,ttype)
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   6) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      INTEGER h,ie,iu,ttype
      complex*16 a(0:5)
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"

c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      a(:) = 0d0

      ie = sign(1,2-h)
      iu = -1

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,-ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,+ie,+1,W(1,3   ))       
         CALL OXXXXX_5(P(0,4   ),ZERO ,+iu,+1,W(1,4   ))       
         CALL IXXXXX_5(P(0,5   ),ZERO ,-iu,-1,W(1,5   )) 
         CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))
         CALL FFV2_3(W(1,5),W(1,4),GC_74,MZ,WZ,W(1,6))
      CALL FFV2_4_2(W(1,2),W(1,6),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(1))
      CALL FFV2_4_1(W(1,3),W(1,6),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(2))

         a( mu) = +AMP(   1)+AMP(   2)
      enddo   
      
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))
      
      return
      END
      

c ------------------------------------------------------------	

      subroutine vvtozzn(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
	call AAtoZZN(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZZN(q1,q2,P,h,az(0,0),ttype)
	call AZtoZZN(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZZN(q1,q2,P,h,zz(0,0),ttype)
c     aa(:,:) = 0d0
c      az(:,:) = 0d0
c      za(:,:) = 0d0
c      zz(:,:) = 0d0

      end
		
      
c ------------------------------------------------------------	
       
      subroutine AAtoZZN(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   6) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  9) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C    
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
c                                                                          
C ----------
C BEGIN CODE
C ----------

      ie = sign(1,2-h)
      iu = -1
      

      
      DO MU = 0,3
         DO NU = 0,3
            
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))	
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  )) 
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV2_3(W(1,6),W(1,5),GC_74,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,9),GC_43,GC_46,AMP(1))
      CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,6),W(1,4),W(1,9),GC_43,GC_46,AMP(2))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,7),W(1,6),W(1,9),GC_43,GC_46,AMP(3))
      CALL FFV1_1(W(1,6),W(1,2),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,3),W(1,5),W(1,9),GC_43,GC_46,AMP(4))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,5),W(1,4),W(1,9),GC_43,GC_46,AMP(5))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,3),W(1,5),W(1,9),GC_43,GC_46,AMP(6))

            
            aa(mu,nu) = -AMP(1)-AMP(2)-AMP(3)-AMP(4)-AMP(5)-AMP(6)
            
         enddo
      enddo
      
      end	
      			
c ------------------------------------------------------------
	
       
      subroutine AZtoZZN(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  13) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  14) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ie = sign(1,2-h)
      iu = -1


      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))		 
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,2),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,8))
      CALL FFV2_3(W(1,6),W(1,5),GC_74,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS6_0(W(1,8),W(1,9),W(1,7),GC_118,AMP(1))
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_43,GC_46,AMP(2))
      CALL FFV2_1(W(1,5),W(1,2),GC_74,ZERO,ZERO,W(1,11))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_43,GC_46,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV2_0(W(1,6),W(1,11),W(1,12),GC_74,AMP(3))
      CALL FFV2_2(W(1,6),W(1,2),GC_74,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_0(W(1,13),W(1,5),W(1,12),GC_74,AMP(4))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,12),W(1,4),W(1,9),GC_43,GC_46,AMP(5))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,12))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,7),W(1,12),W(1,9),GC_43,GC_46,AMP(6))
      CALL FFV2_4_3(W(1,3),W(1,12),GC_43,GC_46,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 7
      CALL FFV2_0(W(1,6),W(1,11),W(1,14),GC_74,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_0(W(1,13),W(1,5),W(1,14),GC_74,AMP(8))
      CALL FFV2_4_1(W(1,12),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_43,GC_46,AMP(9))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_43,GC_46,AMP(10))
      CALL FFV1_1(W(1,10),W(1,1),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_43,GC_46,AMP(11))
      CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,8),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,14))
C     Amplitude(s) for diagram number 12
      CALL VVS6_0(W(1,2),W(1,9),W(1,14),GC_118,AMP(12))
      CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,9),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,14))
C     Amplitude(s) for diagram number 13
      CALL VVS6_0(W(1,2),W(1,8),W(1,14),GC_118,AMP(13))

            az(mu,nu) =-AMP(1)-AMP(2)-AMP(3)-AMP(4)-AMP(5)-AMP(6)-AMP(7)
     $     -AMP(8)-AMP(9)-AMP(10)-AMP(11)-AMP(12)-AMP(13)
            
         enddo
      enddo	
      
      END

c     ------------------------------------------------------------	
c     
      subroutine ZZtoZZN(q1,q2,P,h,zz,ttype)
C     
C     
C     Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C     RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C     FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C     
C     FOR PROCESS : z z -> e+ e- vm vm~  
C     
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  32) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  15) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
      include "coupl.inc"
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = -1

 	
      
      DO MU = 0,3
         DO NU = 0,3
            
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))	
            CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL VVS6_3(W(1,1),W(1,2),GC_118,MH,WH,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV2_3(W(1,6),W(1,5),GC_74,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS1_3_4_7_8_9_0(W(1,8),W(1,9),W(1,7),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(1))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL VVS6_0(W(1,10),W(1,9),W(1,7),GC_118,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL VVS5_9_0(W(1,10),W(1,9),W(1,7),GC_115,GC_119,AMP(3))
      CALL VVS5_9_3(W(1,1),W(1,2),GC_115,GC_119,MH,WH,W(1,7))
C     Amplitude(s) for diagram number 4
      CALL VVS6_0(W(1,10),W(1,9),W(1,7),GC_118,AMP(4))
      CALL FFV2_4_2(W(1,3),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,7),W(1,11),W(1,9),GC_43,GC_46,AMP(5))
      CALL FFV2_1(W(1,5),W(1,2),GC_74,ZERO,ZERO,W(1,12))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_43,GC_46,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 6
      CALL FFV2_0(W(1,6),W(1,12),W(1,13),GC_74,AMP(6))
      CALL FFV2_2(W(1,6),W(1,2),GC_74,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 7
      CALL FFV2_0(W(1,14),W(1,5),W(1,13),GC_74,AMP(7))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,9),GC_43,GC_46,AMP(8))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,13))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,9),GC_43,GC_46,AMP(9))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_43,GC_46,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 10
      CALL FFV2_0(W(1,6),W(1,12),W(1,15),GC_74,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_0(W(1,14),W(1,5),W(1,15),GC_74,AMP(11))
      CALL FFV2_4_1(W(1,13),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_43,GC_46,AMP(12))
      CALL FFV2_1(W(1,5),W(1,1),GC_74,ZERO,ZERO,W(1,15))
      CALL FFV2_3(W(1,6),W(1,15),GC_74,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,13),GC_43,GC_46,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_4_0(W(1,3),W(1,11),W(1,13),GC_43,GC_46,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_0(W(1,14),W(1,15),W(1,10),GC_74,AMP(15))
      CALL FFV2_1(W(1,15),W(1,2),GC_74,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 16
      CALL FFV2_0(W(1,6),W(1,13),W(1,10),GC_74,AMP(16))
      CALL FFV2_2(W(1,6),W(1,1),GC_74,ZERO,ZERO,W(1,13))
      CALL FFV2_3(W(1,13),W(1,5),GC_74,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,15),GC_43,GC_46,AMP(17))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,3),W(1,11),W(1,15),GC_43,GC_46,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV2_0(W(1,13),W(1,12),W(1,10),GC_74,AMP(19))
      CALL FFV2_2(W(1,13),W(1,2),GC_74,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 20
      CALL FFV2_0(W(1,15),W(1,5),W(1,10),GC_74,AMP(20))
      CALL FFV2_4_2(W(1,7),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_43,GC_46,AMP(21))
      CALL FFV2_4_1(W(1,11),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_43,GC_46,AMP(22))
      CALL FFV2_1(W(1,12),W(1,1),GC_74,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 23
      CALL FFV2_0(W(1,6),W(1,15),W(1,10),GC_74,AMP(23))
      CALL FFV2_2(W(1,14),W(1,1),GC_74,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 24
      CALL FFV2_0(W(1,15),W(1,5),W(1,10),GC_74,AMP(24))
      CALL VVS1_3_4_7_8_9_3(W(1,8),W(1,1),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL VVS6_0(W(1,2),W(1,9),W(1,15),GC_118,AMP(25))
      CALL VVS6_3(W(1,1),W(1,9),GC_118,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 26
      CALL VVS1_3_4_7_8_9_0(W(1,8),W(1,2),W(1,15),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(26))
      CALL VVS6_3(W(1,1),W(1,10),GC_118,MH,WH,W(1,8))
C     Amplitude(s) for diagram number 27
      CALL VVS6_0(W(1,2),W(1,9),W(1,8),GC_118,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL VVS5_9_0(W(1,2),W(1,9),W(1,8),GC_115,GC_119,AMP(28))
      CALL VVS5_9_3(W(1,1),W(1,10),GC_115,GC_119,MH,WH,W(1,8))
C     Amplitude(s) for diagram number 29
      CALL VVS6_0(W(1,2),W(1,9),W(1,8),GC_118,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL VVS6_0(W(1,2),W(1,10),W(1,15),GC_118,AMP(30))
C     Amplitude(s) for diagram number 31
      CALL VVS5_9_0(W(1,2),W(1,10),W(1,15),GC_115,GC_119,AMP(31))
      CALL VVS5_9_3(W(1,1),W(1,9),GC_115,GC_119,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 32
      CALL VVS6_0(W(1,2),W(1,10),W(1,15),GC_118,AMP(32))
            
            if (higgs_only) then
               zz(mu,mu) = -amp(1)-amp(2)-amp(3)-amp(4)
     $              -amp(25)-amp(26)-amp(27)-amp(28)-amp(29)-amp(30)            !H->ZZ  graph only
            else   
               zz(mu,nu)=-AMP(1)-AMP(2)-AMP(3)-AMP(4)-AMP(5)-AMP(6)
     $              -AMP(7)-AMP(8)-AMP(9)-AMP(10)-AMP(11)-AMP(12)-AMP(13)
     $              -AMP(14)-AMP(15)-AMP(16)-AMP(17)-AMP(18)-AMP(19)
     $              -AMP(20)-AMP(21)-AMP(22)-AMP(23)-AMP(24)-AMP(25)
     $              -AMP(26)-AMP(27)-AMP(28)-AMP(29)-AMP(30)-AMP(31)-AMP(32)
               
            endif  
            
         enddo
      enddo

      END
c     ------------------------------------------------------------	

      subroutine vvtolln(idb,h,Q,v,aa,az,za,zz,ttype)
      
      IMPLICIT NONE

      integer idb
      real*8 q(0:3), v(0:3,4)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer mu,nu
      integer h,ttype

      call ZZtoLLN(idb,h,Q,v,zz,ttype)
      
      do mu = 0,3
         do nu = 0,3
            aa(mu,nu) = 0d0
            az(mu,nu) = 0d0
            za(mu,nu) = 0d0
         enddo
      enddo   	
      
      end
      
c     ------------------------------------------------------------	
      
      subroutine ZZtoLLN(idb,h,Q,v,zz,ttype)
      
C     Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C     RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C     FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C     
C     FOR PROCESS : z z -> vm vm~  
C     
      IMPLICIT NONE
C     
C     CONSTANTS
C     
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C     
C     ARGUMENTS 
C     
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,iu
      integer ttype
C     
C     LOCAL VARIABLES 
C     
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c     lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lup_loc(6),lum_loc(6)
      double precision qu_loc(0:4)
c     
C     GLOBAL VARIABLES
C     
      include "coupl.inc"
      
      logical lswitch
      parameter (lswitch=.true.)
c     parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------   
c
        if (ttype.eq.1) then
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)
           qu_loc(:) = qu_born(:)
        elseif (ttype.eq.3) then
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   
  
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    q2(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      endif
 
 
      DO MU = 0,3
         DO NU = 0,3
            CALL OXXXXX_5(P(0,3   ),ZERO ,-1,+1,W(1,3   ))        
            CALL IXXXXX_5(P(0,4   ),ZERO ,+1,-1,W(1,4   )) 
            CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   ))
            CALL FFV2_1(W(1,3),W(1,1),GC_74,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV2_0(W(1,4),W(1,5),W(1,2),GC_74,AMP(1))
      CALL FFV2_2(W(1,4),W(1,1),GC_74,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV2_0(W(1,5),W(1,3),W(1,2),GC_74,AMP(2))

            zz(mu,nu)  = -AMP(   1)-AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end
c ==================================================
	
      subroutine WWtoZZ(q1,q2,P,h,ww_munu,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  97) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  16) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'

C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0
      
      ie = sign(1,2-h)
      iu = (-1)**(h+1)
      
      DO MU = 0,3
         DO NU = 0,3
      
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      
      CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
 
      CALL VVV10_2_3_4_7_8_9P0_1(W(1,1),W(1,2),GC_55,GC_105,GC_114
     $ ,GC_104,GC_114,GC_104,GC_57,ZERO,ZERO,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1_2(W(1,5),W(1,7),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(1))
      CALL FFV1_1(W(1,6),W(1,7),GC_3,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,5),W(1,10),W(1,8),GC_3,AMP(2))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,11))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_43,GC_46,AMP(3))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,5),W(1,10),W(1,11),GC_43,GC_46,AMP(4))
      CALL VVV7P0_1(W(1,1),W(1,2),GC_47,ZERO,ZERO,W(1,10))
      CALL FFV1_2(W(1,5),W(1,10),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(5))
      CALL FFV1_1(W(1,6),W(1,10),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,12),W(1,8),GC_3,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_43,GC_46,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,5),W(1,12),W(1,11),GC_43,GC_46,AMP(8))
      CALL VVV1_10_3_5_6_7_9_3(W(1,1),W(1,2),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MZ,WZ,W(1,12))
      CALL FFV2_4_2(W(1,5),W(1,12),GC_43,GC_46,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(9))
      CALL FFV2_4_1(W(1,6),W(1,12),GC_43,GC_46,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,5),W(1,13),W(1,8),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_43,GC_46,AMP(11))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,5),W(1,13),W(1,11),GC_43,GC_46,AMP(12))
      CALL VVV7_3(W(1,1),W(1,2),GC_7,MZ,WZ,W(1,13))
      CALL FFV2_4_2(W(1,5),W(1,13),GC_43,GC_46,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(13))
      CALL FFV2_4_1(W(1,6),W(1,13),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,5),W(1,14),W(1,8),GC_3,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_43,GC_46,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,11),GC_43,GC_46,AMP(16))
      CALL VVS6_3(W(1,1),W(1,2),GC_96,MH,WH,W(1,14))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_43,GC_46,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 17
      CALL VVS1_3_4_7_8_9_0(W(1,8),W(1,9),W(1,14),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(17))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 18
      CALL VVS1_3_4_7_8_9_0(W(1,15),W(1,11),W(1,14),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL VVS6_0(W(1,11),W(1,9),W(1,14),GC_118,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL VVS5_9_0(W(1,11),W(1,9),W(1,14),GC_115,GC_119,AMP(20))
      CALL VVS2_9_3(W(1,1),W(1,2),GC_88,GC_88,MH,WH,W(1,14))
C     Amplitude(s) for diagram number 21
      CALL VVS6_0(W(1,11),W(1,9),W(1,14),GC_118,AMP(21))
      CALL FFV1_2(W(1,3),W(1,7),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,14),W(1,4),W(1,15),GC_3,AMP(22))
      CALL FFV1_1(W(1,4),W(1,7),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,3),W(1,16),W(1,15),GC_3,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_43,GC_46,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_43,GC_46,AMP(25))
      CALL FFV1_2(W(1,3),W(1,10),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,16),W(1,4),W(1,15),GC_3,AMP(26))
      CALL FFV1_1(W(1,4),W(1,10),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,14),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,16),W(1,4),W(1,9),GC_43,GC_46,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_43,GC_46,AMP(29))
      CALL FFV2_4_2(W(1,3),W(1,12),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,14),W(1,4),W(1,15),GC_3,AMP(30))
      CALL FFV2_4_1(W(1,4),W(1,12),GC_43,GC_46,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,3),W(1,16),W(1,15),GC_3,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_43,GC_46,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_43,GC_46,AMP(33))
      CALL FFV2_4_2(W(1,3),W(1,13),GC_43,GC_46,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,16),W(1,4),W(1,15),GC_3,AMP(34))
      CALL FFV2_4_1(W(1,4),W(1,13),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,14),W(1,15),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,16),W(1,4),W(1,9),GC_43,GC_46,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_43,GC_46,AMP(37))
      CALL FFV2_2(W(1,3),W(1,1),GC_42,ZERO,ZERO,W(1,14))
      CALL FFV2_1(W(1,4),W(1,2),GC_42,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 38
      CALL FFV2_0(W(1,14),W(1,16),W(1,9),GC_74,AMP(38))
      CALL FFV2_1(W(1,6),W(1,2),GC_42,ZERO,ZERO,W(1,13))
      CALL FFV2_3(W(1,14),W(1,4),GC_42,MW,WW,W(1,12))
C     Amplitude(s) for diagram number 39
      CALL FFV2_0(W(1,5),W(1,13),W(1,12),GC_42,AMP(39))
      CALL FFV2_2(W(1,14),W(1,2),GC_42,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,10),W(1,4),W(1,15),GC_3,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL VVV10_2_3_4_7_8_9_0(W(1,15),W(1,12),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(41))
C     Amplitude(s) for diagram number 42
      CALL VVV7_0(W(1,15),W(1,12),W(1,2),GC_47,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL FFV2_4_0(W(1,10),W(1,4),W(1,9),GC_43,GC_46,AMP(43))
C     Amplitude(s) for diagram number 44
      CALL VVV1_10_3_5_6_7_9_0(W(1,12),W(1,2),W(1,9),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL VVV7_0(W(1,12),W(1,2),W(1,9),GC_7,AMP(45))
      CALL FFV2_2(W(1,5),W(1,1),GC_42,ZERO,ZERO,W(1,12))
      CALL FFV2_3(W(1,12),W(1,6),GC_42,MW,WW,W(1,10))
C     Amplitude(s) for diagram number 46
      CALL FFV2_0(W(1,3),W(1,16),W(1,10),GC_42,AMP(46))
C     Amplitude(s) for diagram number 47
      CALL FFV2_0(W(1,12),W(1,13),W(1,11),GC_74,AMP(47))
      CALL FFV2_2(W(1,12),W(1,2),GC_42,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 48
      CALL FFV1_0(W(1,4),W(1,6),W(1,8),GC_3,AMP(48))
C     Amplitude(s) for diagram number 49
      CALL VVV10_2_3_4_7_8_9_0(W(1,8),W(1,10),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(49))
C     Amplitude(s) for diagram number 50
      CALL VVV7_0(W(1,8),W(1,10),W(1,2),GC_47,AMP(50))
C     Amplitude(s) for diagram number 51
      CALL FFV2_4_0(W(1,4),W(1,6),W(1,11),GC_43,GC_46,AMP(51))
C     Amplitude(s) for diagram number 52
      CALL VVV1_10_3_5_6_7_9_0(W(1,10),W(1,2),W(1,11),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(52))
C     Amplitude(s) for diagram number 53
      CALL VVV7_0(W(1,10),W(1,2),W(1,11),GC_7,AMP(53))
      CALL FFV2_1(W(1,16),W(1,1),GC_42,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 54
      CALL FFV1_0(W(1,3),W(1,10),W(1,15),GC_3,AMP(54))
      CALL VVV10_2_3_4_7_8_9_3(W(1,15),W(1,1),GC_55,GC_105,GC_114
     $ ,GC_104,GC_114,GC_104,GC_57,MW,WW,W(1,4))
C     Amplitude(s) for diagram number 55
      CALL FFV2_0(W(1,3),W(1,16),W(1,4),GC_42,AMP(55))
      CALL VVV7_3(W(1,15),W(1,1),GC_47,MW,WW,W(1,6))
C     Amplitude(s) for diagram number 56
      CALL FFV2_0(W(1,3),W(1,16),W(1,6),GC_42,AMP(56))
C     Amplitude(s) for diagram number 57
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,9),GC_43,GC_46,AMP(57))
      CALL VVV1_10_3_5_6_7_9_2(W(1,1),W(1,9),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MW,WW,W(1,10))
C     Amplitude(s) for diagram number 58
      CALL FFV2_0(W(1,3),W(1,16),W(1,10),GC_42,AMP(58))
      CALL VVV7_2(W(1,1),W(1,9),GC_7,MW,WW,W(1,12))
C     Amplitude(s) for diagram number 59
      CALL FFV2_0(W(1,3),W(1,16),W(1,12),GC_42,AMP(59))
      CALL FFV2_1(W(1,13),W(1,1),GC_42,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 60
      CALL FFV1_0(W(1,5),W(1,16),W(1,8),GC_3,AMP(60))
      CALL VVV10_2_3_4_7_8_9_3(W(1,8),W(1,1),GC_55,GC_105,GC_114
     $ ,GC_104,GC_114,GC_104,GC_57,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 61
      CALL FFV2_0(W(1,5),W(1,13),W(1,3),GC_42,AMP(61))
      CALL VVV7_3(W(1,8),W(1,1),GC_47,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 62
      CALL FFV2_0(W(1,5),W(1,13),W(1,14),GC_42,AMP(62))
C     Amplitude(s) for diagram number 63
      CALL FFV2_4_0(W(1,5),W(1,16),W(1,11),GC_43,GC_46,AMP(63))
      CALL VVV1_10_3_5_6_7_9_2(W(1,1),W(1,11),GC_112,GC_18,GC_108
     $ ,GC_112,GC_110,GC_108,GC_20,MW,WW,W(1,16))
C     Amplitude(s) for diagram number 64
      CALL FFV2_0(W(1,5),W(1,13),W(1,16),GC_42,AMP(64))
      CALL VVV7_2(W(1,1),W(1,11),GC_7,MW,WW,W(1,7))
C     Amplitude(s) for diagram number 65
      CALL FFV2_0(W(1,5),W(1,13),W(1,7),GC_42,AMP(65))
C     Amplitude(s) for diagram number 66
      CALL VVVV4_0(W(1,8),W(1,15),W(1,1),W(1,2),GC_66,AMP(66))
C     Amplitude(s) for diagram number 67
      CALL VVVV2_9_0(W(1,8),W(1,15),W(1,1),W(1,2),GC_67,GC_68,AMP(67))
C     Amplitude(s) for diagram number 68
      CALL VVV7_0(W(1,15),W(1,3),W(1,2),GC_47,AMP(68))
C     Amplitude(s) for diagram number 69
      CALL VVV10_2_3_4_7_8_9_0(W(1,15),W(1,14),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(69))
C     Amplitude(s) for diagram number 70
      CALL VVV7_0(W(1,15),W(1,14),W(1,2),GC_47,AMP(70))
C     Amplitude(s) for diagram number 71
      CALL VVV7_0(W(1,8),W(1,4),W(1,2),GC_47,AMP(71))
C     Amplitude(s) for diagram number 72
      CALL VVV10_2_3_4_7_8_9_0(W(1,8),W(1,6),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(72))
C     Amplitude(s) for diagram number 73
      CALL VVV7_0(W(1,8),W(1,6),W(1,2),GC_47,AMP(73))
C     Amplitude(s) for diagram number 74
      CALL VVVV7_0(W(1,8),W(1,1),W(1,2),W(1,9),GC_49,AMP(74))
C     Amplitude(s) for diagram number 75
      CALL VVVV3_7_8_0(W(1,8),W(1,1),W(1,2),W(1,9),GC_58,GC_127,GC_59
     $ ,AMP(75))
C     Amplitude(s) for diagram number 76
      CALL VVV7_0(W(1,3),W(1,2),W(1,9),GC_7,AMP(76))
C     Amplitude(s) for diagram number 77
      CALL VVV1_10_3_5_6_7_9_0(W(1,14),W(1,2),W(1,9),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(77))
C     Amplitude(s) for diagram number 78
      CALL VVV7_0(W(1,14),W(1,2),W(1,9),GC_7,AMP(78))
C     Amplitude(s) for diagram number 79
      CALL VVV7_0(W(1,8),W(1,10),W(1,2),GC_47,AMP(79))
C     Amplitude(s) for diagram number 80
      CALL VVV10_2_3_4_7_8_9_0(W(1,8),W(1,12),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(80))
C     Amplitude(s) for diagram number 81
      CALL VVV7_0(W(1,8),W(1,12),W(1,2),GC_47,AMP(81))
C     Amplitude(s) for diagram number 82
      CALL VVVV7_0(W(1,15),W(1,1),W(1,2),W(1,11),GC_49,AMP(82))
C     Amplitude(s) for diagram number 83
      CALL VVVV3_7_8_0(W(1,15),W(1,1),W(1,2),W(1,11),GC_58,GC_127
     $ ,GC_59,AMP(83))
C     Amplitude(s) for diagram number 84
      CALL VVV7_0(W(1,15),W(1,16),W(1,2),GC_47,AMP(84))
C     Amplitude(s) for diagram number 85
      CALL VVV10_2_3_4_7_8_9_0(W(1,15),W(1,7),W(1,2),GC_55,GC_105
     $ ,GC_114,GC_104,GC_114,GC_104,GC_57,AMP(85))
C     Amplitude(s) for diagram number 86
      CALL VVV7_0(W(1,15),W(1,7),W(1,2),GC_47,AMP(86))
C     Amplitude(s) for diagram number 87
      CALL VVV7_0(W(1,4),W(1,2),W(1,11),GC_7,AMP(87))
C     Amplitude(s) for diagram number 88
      CALL VVV1_10_3_5_6_7_9_0(W(1,6),W(1,2),W(1,11),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(88))
C     Amplitude(s) for diagram number 89
      CALL VVV7_0(W(1,6),W(1,2),W(1,11),GC_7,AMP(89))
C     Amplitude(s) for diagram number 90
      CALL VVVV4_0(W(1,1),W(1,2),W(1,11),W(1,9),GC_12,AMP(90))
C     Amplitude(s) for diagram number 91
      CALL VVVV2_4_9_0(W(1,1),W(1,2),W(1,11),W(1,9),GC_22,GC_126,GC_25
     $ ,AMP(91))
C     Amplitude(s) for diagram number 92
      CALL VVV7_0(W(1,16),W(1,2),W(1,9),GC_7,AMP(92))
C     Amplitude(s) for diagram number 93
      CALL VVV1_10_3_5_6_7_9_0(W(1,7),W(1,2),W(1,9),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(93))
C     Amplitude(s) for diagram number 94
      CALL VVV7_0(W(1,7),W(1,2),W(1,9),GC_7,AMP(94))
C     Amplitude(s) for diagram number 95
      CALL VVV7_0(W(1,10),W(1,2),W(1,11),GC_7,AMP(95))
C     Amplitude(s) for diagram number 96
      CALL VVV1_10_3_5_6_7_9_0(W(1,12),W(1,2),W(1,11),GC_112,GC_18
     $ ,GC_108,GC_112,GC_110,GC_108,GC_20,AMP(96))
C     Amplitude(s) for diagram number 97
      CALL VVV7_0(W(1,12),W(1,2),W(1,11),GC_7,AMP(97))

c      if(higgs_only) then
c
c         ww_munu(mu,nu) = amp(37)    !H->ZZ  graph only
c      
c      else    

      WW_MUNU(MU,NU) = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)+AMP(41)+AMP(42)+AMP(43)+AMP(44)
     $ +AMP(45)+AMP(46)+AMP(47)+AMP(48)+AMP(49)+AMP(50)+AMP(51)
     $ +AMP(52)+AMP(53)+AMP(54)+AMP(55)+AMP(56)+AMP(57)+AMP(58)
     $ +AMP(59)+AMP(60)+AMP(61)+AMP(62)+AMP(63)+AMP(64)+AMP(65)
     $ +AMP(66)+AMP(67)+AMP(68)+AMP(69)+AMP(70)+AMP(71)+AMP(72)
     $ +AMP(73)+AMP(74)+AMP(75)+AMP(76)+AMP(77)+AMP(78)+AMP(79)
     $ +AMP(80)+AMP(81)+AMP(82)+AMP(83)+AMP(84)+AMP(85)+AMP(86)
     $ +AMP(87)+AMP(88)+AMP(89)+AMP(90)+AMP(91)+AMP(92)+AMP(93)
     $ +AMP(94)+AMP(95)+AMP(96)+AMP(97)
     
c      endif
     
            ENDDO
      ENDDO

      END
c ------------------------------------------------------------	

    
c ------------------------------------------------------------	
c
      subroutine WWtoLL(idb,idl,h,Q,v,wll,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: wll(mu,nu)  lepton tensor for w w--> l+l-  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> l+ l-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   5) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wll(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif

      DO MU = 0,3
         DO NU = 0,3
            if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   ))              
            endif

      CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
      CALL VVV10_2_3_4_7_8_9P0_1(W(1,1),W(1,2),GC_55,GC_105,GC_114
     $     ,GC_104,GC_114,GC_104,GC_57,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,3),W(1,4),W(1,5),GC_3,AMP(1))
      CALL VVV7P0_1(W(1,1),W(1,2),GC_47,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,3),W(1,4),W(1,5),GC_3,AMP(2))
      CALL VVV1_10_3_5_6_7_9_3(W(1,1),W(1,2),GC_112,GC_18,GC_108
     $     ,GC_112,GC_110,GC_108,GC_20,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,3),W(1,4),W(1,5),GC_43,GC_46,AMP(3))
      CALL VVV7_3(W(1,1),W(1,2),GC_7,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,3),W(1,4),W(1,5),GC_43,GC_46,AMP(4))
      CALL FFV2_2(W(1,3),W(1,1),GC_42,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 5
      CALL FFV2_0(W(1,5),W(1,4),W(1,2),GC_42,AMP(5))
      
      wll(mu,nu) =+AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)
     	 enddo !nu
      enddo !mu

      end
      
c ------------------------------------------------------------	
       

       
   
c ------------------------------------------------------------	

      subroutine vvtozz(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
      	call AAtoZZ(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZZ(q1,q2,P,h,az(0,0),ttype)
	call AZtoZZ(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZZ(q1,q2,P,h,zz(0,0),ttype)
		
      end
		
c ------------------------------------------------------------	
       
      subroutine AAtoZZ(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      aa(:,:) = 0d0

      IF (HIGGS_ONLY) RETURN

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
      
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
            
            
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  ))      
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
            CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
            CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
            CALL FFV2_4_3(W(1,5),W(1,6),GC_43,GC_46,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_43,GC_46,AMP(2))
            CALL FFV1_2(W(1,5),W(1,2),GC_3,ZERO,ZERO,W(1,11))
            CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
            CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(3))
            CALL FFV2_4_3(W(1,7),W(1,4),GC_43,GC_46,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
            CALL FFV2_4_0(W(1,11),W(1,6),W(1,13),GC_43,GC_46,AMP(4))
            CALL FFV1_1(W(1,6),W(1,2),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
            CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(5))
C     Amplitude(s) for diagram number 6
            CALL FFV2_4_0(W(1,5),W(1,14),W(1,13),GC_43,GC_46,AMP(6))
            CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
            CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
            CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_43,GC_46,AMP(8))
            CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
            CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
            CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
            CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_43,GC_46,AMP(10))
            CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
            CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(11))
            CALL FFV2_4_3(W(1,3),W(1,13),GC_43,GC_46,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
            CALL FFV2_4_0(W(1,11),W(1,6),W(1,15),GC_43,GC_46,AMP(12))
C     Amplitude(s) for diagram number 13
            CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(13))
C     Amplitude(s) for diagram number 14
            CALL FFV2_4_0(W(1,5),W(1,14),W(1,15),GC_43,GC_46,AMP(14))
            CALL FFV1_1(W(1,13),W(1,2),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
            CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
            CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_43,GC_46,AMP(16))
            CALL FFV1_2(W(1,5),W(1,1),GC_3,ZERO,ZERO,W(1,15))
            CALL FFV1P0_3(W(1,15),W(1,6),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
            CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
            CALL FFV2_4_3(W(1,15),W(1,6),GC_43,GC_46,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
            CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_43,GC_46,AMP(18))
C     Amplitude(s) for diagram number 19
            CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
            CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_43,GC_46,AMP(20))
            CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
            CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_3,AMP(21))
            CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
            CALL FFV2_4_0(W(1,15),W(1,14),W(1,13),GC_43,GC_46,AMP(22))
            CALL FFV1_2(W(1,15),W(1,2),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
            CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_3,AMP(23))
C     Amplitude(s) for diagram number 24
            CALL FFV2_4_0(W(1,16),W(1,6),W(1,13),GC_43,GC_46,AMP(24))
            CALL FFV1_1(W(1,6),W(1,1),GC_3,ZERO,ZERO,W(1,16))
            CALL FFV1P0_3(W(1,5),W(1,16),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
            CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
            CALL FFV2_4_3(W(1,5),W(1,16),GC_43,GC_46,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
            CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_43,GC_46,AMP(26))
C     Amplitude(s) for diagram number 27
            CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
            CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_43,GC_46,AMP(28))
C     Amplitude(s) for diagram number 29
            CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_3,AMP(29))
C     Amplitude(s) for diagram number 30
            CALL FFV2_4_0(W(1,11),W(1,16),W(1,13),GC_43,GC_46,AMP(30))
            CALL FFV1_1(W(1,16),W(1,2),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
            CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(31))
C     Amplitude(s) for diagram number 32
            CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_43,GC_46,AMP(32))
            CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
            CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
            CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_43,GC_46,AMP(34))
            CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
            CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
            CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_43,GC_46,AMP(36))
            CALL FFV1_2(W(1,11),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
            CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_3,AMP(37))
C     Amplitude(s) for diagram number 38
            CALL FFV2_4_0(W(1,17),W(1,6),W(1,13),GC_43,GC_46,AMP(38))
            CALL FFV1_1(W(1,14),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
            CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(39))
C     Amplitude(s) for diagram number 40
            CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_43,GC_46,AMP(40))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &           +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &           +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &           +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &           +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &           +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &           +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &           +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
            
         enddo
      enddo
      
      end
      
				
c ------------------------------------------------------------
	
       
      subroutine AZtoZZ(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  43) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      az(:,:) = 0d0

      if (higgs_only) return 

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
      
           
      DO MU = 0,3
         DO NU = 0,3
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
 
      CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,2),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,8))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_43,GC_46,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS6_0(W(1,8),W(1,9),W(1,7),GC_118,AMP(1))
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,10))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,7),W(1,10),W(1,11),GC_3,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_43,GC_46,AMP(3))
      CALL FFV2_4_2(W(1,5),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,12))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_3,AMP(4))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_43,GC_46,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,12),W(1,6),W(1,14),GC_43,GC_46,AMP(5))
      CALL FFV2_4_1(W(1,6),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_3,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,14),GC_43,GC_46,AMP(7))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,14),W(1,4),W(1,11),GC_3,AMP(8))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_43,GC_46,AMP(9))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,14))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,7),W(1,14),W(1,11),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,7),W(1,14),W(1,9),GC_43,GC_46,AMP(11))
      CALL FFV1P0_3(W(1,3),W(1,14),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 12
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_3,AMP(12))
      CALL FFV2_4_3(W(1,3),W(1,14),GC_43,GC_46,MZ,WZ,W(1,16))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,12),W(1,6),W(1,16),GC_43,GC_46,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_3,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,16),GC_43,GC_46,AMP(15))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 16
      CALL FFV1_0(W(1,3),W(1,16),W(1,11),GC_3,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_43,GC_46,AMP(17))
      CALL FFV1_2(W(1,5),W(1,1),GC_3,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,16),W(1,6),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV1_0(W(1,7),W(1,4),W(1,14),GC_3,AMP(18))
      CALL FFV2_4_3(W(1,16),W(1,6),GC_43,GC_46,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,13),GC_43,GC_46,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,3),W(1,10),W(1,14),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,13),GC_43,GC_46,AMP(21))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,16),W(1,15),W(1,13),GC_3,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL FFV2_4_0(W(1,16),W(1,15),W(1,8),GC_43,GC_46,AMP(23))
      CALL FFV2_4_2(W(1,16),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 24
      CALL FFV1_0(W(1,14),W(1,6),W(1,13),GC_3,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_4_0(W(1,14),W(1,6),W(1,8),GC_43,GC_46,AMP(25))
      CALL FFV1_1(W(1,6),W(1,1),GC_3,ZERO,ZERO,W(1,14))
      CALL FFV1P0_3(W(1,5),W(1,14),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,7),W(1,4),W(1,16),GC_3,AMP(26))
      CALL FFV2_4_3(W(1,5),W(1,14),GC_43,GC_46,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 27
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_43,GC_46,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV1_0(W(1,3),W(1,10),W(1,16),GC_3,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,17),GC_43,GC_46,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,12),W(1,14),W(1,13),GC_3,AMP(30))
C     Amplitude(s) for diagram number 31
      CALL FFV2_4_0(W(1,12),W(1,14),W(1,8),GC_43,GC_46,AMP(31))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 32
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_3,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,8),GC_43,GC_46,AMP(33))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,17),W(1,4),W(1,11),GC_3,AMP(34))
C     Amplitude(s) for diagram number 35
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,9),GC_43,GC_46,AMP(35))
      CALL FFV1_1(W(1,10),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 36
      CALL FFV1_0(W(1,3),W(1,17),W(1,11),GC_3,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,9),GC_43,GC_46,AMP(37))
      CALL FFV1_2(W(1,12),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 38
      CALL FFV1_0(W(1,17),W(1,6),W(1,13),GC_3,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL FFV2_4_0(W(1,17),W(1,6),W(1,8),GC_43,GC_46,AMP(39))
      CALL FFV1_1(W(1,15),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_3,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,8),GC_43,GC_46,AMP(41))
      CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,8),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 42
      CALL VVS6_0(W(1,2),W(1,9),W(1,17),GC_118,AMP(42))
      CALL VVS1_3_4_7_8_9_3(W(1,1),W(1,9),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 43
      CALL VVS6_0(W(1,2),W(1,8),W(1,17),GC_118,AMP(43))
      
      az(mu,nu) = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)+AMP(41)+AMP(42)+AMP(43)
	
	  enddo
       enddo	

      END

c ------------------------------------------------------------	
c       
      subroutine ZZtoZZ(q1,q2,P,h,zz,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=  55) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

      DO MU = 0,3
         DO NU = 0,3
         CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      

      CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL VVS6_3(W(1,1),W(1,2),GC_118,MH,WH,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_43,GC_46,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS1_3_4_7_8_9_0(W(1,8),W(1,9),W(1,7),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(1))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_43,GC_46,MZ,WZ,W(1,10))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 2
      CALL VVS1_3_4_7_8_9_0(W(1,11),W(1,10),W(1,7),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL VVS6_0(W(1,10),W(1,9),W(1,7),GC_118,AMP(3))
C     Amplitude(s) for diagram number 4
      CALL VVS5_9_0(W(1,10),W(1,9),W(1,7),GC_115,GC_119,AMP(4))
      CALL VVS5_9_3(W(1,1),W(1,2),GC_115,GC_119,MH,WH,W(1,7))
C     Amplitude(s) for diagram number 5
      CALL VVS6_0(W(1,10),W(1,9),W(1,7),GC_118,AMP(5))
      CALL FFV2_4_2(W(1,3),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,7),W(1,12),W(1,11),GC_3,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,7),W(1,12),W(1,9),GC_43,GC_46,AMP(7))
      CALL FFV2_4_2(W(1,5),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,13))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,13),W(1,6),W(1,14),GC_3,AMP(8))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_43,GC_46,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,13),W(1,6),W(1,15),GC_43,GC_46,AMP(9))
      CALL FFV2_4_1(W(1,6),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,5),W(1,16),W(1,14),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,5),W(1,16),W(1,15),GC_43,GC_46,AMP(11))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV1_0(W(1,15),W(1,4),W(1,11),GC_3,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_43,GC_46,AMP(13))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,7),W(1,15),W(1,11),GC_3,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_4_0(W(1,7),W(1,15),W(1,9),GC_43,GC_46,AMP(15))
      CALL FFV1P0_3(W(1,3),W(1,15),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 16
      CALL FFV1_0(W(1,13),W(1,6),W(1,14),GC_3,AMP(16))
      CALL FFV2_4_3(W(1,3),W(1,15),GC_43,GC_46,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,13),W(1,6),W(1,17),GC_43,GC_46,AMP(17))
C     Amplitude(s) for diagram number 18
      CALL FFV1_0(W(1,5),W(1,16),W(1,14),GC_3,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,5),W(1,16),W(1,17),GC_43,GC_46,AMP(19))
      CALL FFV2_4_1(W(1,15),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,3),W(1,17),W(1,11),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,9),GC_43,GC_46,AMP(21))
      CALL FFV2_4_2(W(1,5),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,17))
      CALL FFV1P0_3(W(1,17),W(1,6),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(22))
      CALL FFV2_4_3(W(1,17),W(1,6),GC_43,GC_46,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 23
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,14),GC_43,GC_46,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV1_0(W(1,3),W(1,12),W(1,15),GC_3,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_4_0(W(1,3),W(1,12),W(1,14),GC_43,GC_46,AMP(25))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,17),W(1,16),W(1,8),GC_3,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV2_4_0(W(1,17),W(1,16),W(1,10),GC_43,GC_46,AMP(27))
      CALL FFV2_4_2(W(1,17),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 28
      CALL FFV1_0(W(1,14),W(1,6),W(1,8),GC_3,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,14),W(1,6),W(1,10),GC_43,GC_46,AMP(29))
      CALL FFV2_4_1(W(1,6),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,14))
      CALL FFV1P0_3(W(1,5),W(1,14),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,7),W(1,4),W(1,17),GC_3,AMP(30))
      CALL FFV2_4_3(W(1,5),W(1,14),GC_43,GC_46,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 31
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,15),GC_43,GC_46,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV1_0(W(1,3),W(1,12),W(1,17),GC_3,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,3),W(1,12),W(1,15),GC_43,GC_46,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,13),W(1,14),W(1,8),GC_3,AMP(34))
C     Amplitude(s) for diagram number 35
      CALL FFV2_4_0(W(1,13),W(1,14),W(1,10),GC_43,GC_46,AMP(35))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 36
      CALL FFV1_0(W(1,5),W(1,15),W(1,8),GC_3,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,10),GC_43,GC_46,AMP(37))
      CALL FFV2_4_2(W(1,7),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 38
      CALL FFV1_0(W(1,15),W(1,4),W(1,11),GC_3,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_43,GC_46,AMP(39))
      CALL FFV2_4_1(W(1,12),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,3),W(1,15),W(1,11),GC_3,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_43,GC_46,AMP(41))
      CALL FFV2_4_2(W(1,13),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 42
      CALL FFV1_0(W(1,15),W(1,6),W(1,8),GC_3,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL FFV2_4_0(W(1,15),W(1,6),W(1,10),GC_43,GC_46,AMP(43))
      CALL FFV2_4_1(W(1,16),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 44
      CALL FFV1_0(W(1,5),W(1,15),W(1,8),GC_3,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,10),GC_43,GC_46,AMP(45))
      CALL VVS1_3_4_7_8_9_3(W(1,8),W(1,1),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 46
      CALL VVS6_0(W(1,2),W(1,9),W(1,15),GC_118,AMP(46))
      CALL VVS6_3(W(1,1),W(1,9),GC_118,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 47
      CALL VVS1_3_4_7_8_9_0(W(1,8),W(1,2),W(1,15),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(47))
      CALL VVS6_3(W(1,1),W(1,10),GC_118,MH,WH,W(1,8))
C     Amplitude(s) for diagram number 48
      CALL VVS1_3_4_7_8_9_0(W(1,11),W(1,2),W(1,8),GC_103,GC_86,GC_97
     $ ,GC_120,GC_120,GC_116,AMP(48))
      CALL VVS1_3_4_7_8_9_3(W(1,11),W(1,1),GC_103,GC_86,GC_97,GC_120
     $ ,GC_120,GC_116,MH,WH,W(1,5))
C     Amplitude(s) for diagram number 49
      CALL VVS6_0(W(1,2),W(1,10),W(1,5),GC_118,AMP(49))
C     Amplitude(s) for diagram number 50
      CALL VVS6_0(W(1,2),W(1,9),W(1,8),GC_118,AMP(50))
C     Amplitude(s) for diagram number 51
      CALL VVS5_9_0(W(1,2),W(1,9),W(1,8),GC_115,GC_119,AMP(51))
      CALL VVS5_9_3(W(1,1),W(1,10),GC_115,GC_119,MH,WH,W(1,8))
C     Amplitude(s) for diagram number 52
      CALL VVS6_0(W(1,2),W(1,9),W(1,8),GC_118,AMP(52))
C     Amplitude(s) for diagram number 53
      CALL VVS6_0(W(1,2),W(1,10),W(1,15),GC_118,AMP(53))
C     Amplitude(s) for diagram number 54
      CALL VVS5_9_0(W(1,2),W(1,10),W(1,15),GC_115,GC_119,AMP(54))
      CALL VVS5_9_3(W(1,1),W(1,9),GC_115,GC_119,MH,WH,W(1,15))
C     Amplitude(s) for diagram number 55
      CALL VVS6_0(W(1,2),W(1,10),W(1,15),GC_118,AMP(55))

c      if (higgs_only) then !H->ZZ
c      
c      zz(mu,nu) = amp(31) + amp(36) + amp(43)! amp(36.43) are t-channel
c
c      else
      
      zz(mu,nu)  = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)+AMP(41)+AMP(42)+AMP(43)+AMP(44)
     $ +AMP(45)+AMP(46)+AMP(47)+AMP(48)+AMP(49)+AMP(50)+AMP(51)
     $ +AMP(52)+AMP(53)+AMP(54)+AMP(55)
 
c      endif !honly

	  enddo
       enddo

      END
c ------------------------------------------------------------	

 
c ------------------------------------------------------------	

        subroutine vvtoll(idb,idl,h,Q,v,aa,az,za,zz,ttype)
	
        IMPLICIT NONE

        integer idb,idl,h
        integer ttype
        real*8 q(0:3), v(0:3,4)
        complex*16 aa(0:3,0:3)
        complex*16 az(0:3,0:3)
        complex*16 za(0:3,0:3)
        complex*16 zz(0:3,0:3)
      
        aa(:,:) = 0d0
        az(:,:) = 0d0
        za(:,:) = 0d0
        zz(:,:) = 0d0

	call AAtoLL(idb,idl,Q,v,h,aa(0,0),ttype)
	call AZtoLL(idb,idl,Q,v,h,az(0,0),ttype)
	call ZAtoLL(idb,idl,Q,v,h,za(0,0),ttype) 
        call ZZtoLL(idb,idl,Q,v,h,zz(0,0),ttype)

	end
	
c ------------------------------------------------------------	

       
      subroutine AAtoLL(idb,idl,Q,v,h,aa,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a a --> l+l-  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C    
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      aa(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif
      
      DO MU = 0,3
         DO NU = 0,3
      if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))	     
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif

      CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
      CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  )) 
      
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_3,AMP(1))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_3,AMP(2))

      aa(mu,nu) = +AMP(   1)+AMP(   2)
        
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	
       
      subroutine AZtoLL(idb,idl,Q,v,h,az,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> l+l-  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 az(0:3,0:3)
      integer il,h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      az(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif
	 
      DO MU = 0,3
         DO NU = 0,3
      if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif

      CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV2_4_0(W(1,5),W(1,4),W(1,2),GC_43,GC_46,AMP(1))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,3),W(1,5),W(1,2),GC_43,GC_46,AMP(2))
      
      az(mu,nu) = +AMP(   1)+AMP(   2)
         
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	
       
      subroutine ZAtoLL(idb,idl,Q,v,h,za,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> l+l-  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z a -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 za(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      za(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif

      DO MU = 0,3
         DO NU = 0,3
      if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif

      CALL VCARTX_5(Q1(0),zmass ,zwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),zero  ,zero , NU,-1,W(1,2   )) 
      CALL FFV2_4_2(W(1,3),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_3,AMP(1))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_3,AMP(2))
      
      za(mu,nu) = +AMP(   1)+AMP(   2)
 
 	 enddo !nu
      enddo !mu

      end



c ------------------------------------------------------------	
       
      subroutine ZZtoLL(idb,idl,Q,v,h,zz,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for z z --> l+l-  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif

      DO MU = 0,3
         DO NU = 0,3
            if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif

      
      CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL FFV2_4_2(W(1,3),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
      CALL FFV2_4_0(W(1,5),W(1,4),W(1,2),GC_43,GC_46,AMP(1))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,3),W(1,5),W(1,2),GC_43,GC_46,AMP(2))
      
      zz(mu,nu) = +AMP(   1)+AMP(   2)
        
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	



c ------------------------------------------------------------	

      subroutine vto4l(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer h,ie,iu
      integer ttype

      z4l(:) = 0d0
      a4l(:) = 0d0

	call Zto4l(P,h,z4l,ttype)
	call Ato4l(P,h,a4l,ttype)
		
	end
		
c ------------------------------------------------------------	
c ------------------------------------------------------------	
   
      subroutine Zto4L(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)

C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C  
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
      CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
      CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
      CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
                   
      CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))
      CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,4),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
      CALL FFV2_4_0(W(1,7),W(1,5),W(1,1),GC_43,GC_46,AMP(1))
      CALL FFV1_1(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,4),W(1,7),W(1,1),GC_43,GC_46,AMP(2))
      CALL FFV2_4_3(W(1,2),W(1,3),GC_43,GC_46,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,4),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,6),W(1,5),W(1,1),GC_43,GC_46,AMP(3))
      CALL FFV2_4_1(W(1,5),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,4),W(1,6),W(1,1),GC_43,GC_46,AMP(4))
      CALL FFV1P0_3(W(1,4),W(1,5),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,7),W(1,3),W(1,1),GC_43,GC_46,AMP(5))
      CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,2),W(1,7),W(1,1),GC_43,GC_46,AMP(6))
      CALL FFV2_4_3(W(1,4),W(1,5),GC_43,GC_46,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,2),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_43,GC_46,AMP(7))
      CALL FFV2_4_1(W(1,3),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_43,GC_46,AMP(8))
      z(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &             -AMP(   6)-AMP(   7)-AMP(   8)
      enddo
             
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))

      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4L(P,h,a,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 a(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      a(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
      CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
      CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
      CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
        

         CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))
      CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,4),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,5),W(1,1),GC_3,AMP(1))
      CALL FFV1_1(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,4),W(1,7),W(1,1),GC_3,AMP(2))
      CALL FFV2_4_3(W(1,2),W(1,3),GC_43,GC_46,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,4),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,6),W(1,5),W(1,1),GC_3,AMP(3))
      CALL FFV2_4_1(W(1,5),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,4),W(1,6),W(1,1),GC_3,AMP(4))
      CALL FFV1P0_3(W(1,4),W(1,5),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,7),W(1,3),W(1,1),GC_3,AMP(5))
      CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,2),W(1,7),W(1,1),GC_3,AMP(6))
      CALL FFV2_4_3(W(1,4),W(1,5),GC_43,GC_46,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,2),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(7))
      CALL FFV2_4_1(W(1,3),W(1,7),GC_43,GC_46,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(8))

      a(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &             -AMP(   6)-AMP(   7)-AMP(   8)
     
      enddo   
     
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))

      return
      END
      

c ------------------------------------------------------------	




      subroutine vcartx_5(p,vmass,vwidth,ncart,nsv , vc)
c
c This subroutine computes an effective VECTOR wavefunction for an internal
c vector boson line. The propagator is inlcuded in the Feynman gauge.
c
c input:
c       real    p(0:3)         : four-momentum of vector boson
c       real    vmass          : mass          of vector boson
c       integer ncart = 0,1,2,3: cartesian polarization direction
c                                of vector boson
c       integer nsv  = -1 or 1 : +1 for final, -1 for initial
c
c output:
c       complex vc(6)          : vector wavefunction       epsilon^mu(v)
c     
      implicit none
      double complex vc(6), d
      double precision p(0:3),vmass,vwidth,q2
      integer ncart, mu, nsv

      q2 = p(0)**2-p(1)**2-p(2)**2-p(3)**2
      if (vmass.eq.0d0) then
         d = 1d0/q2
      else
         d = 1d0/dcmplx( q2-vmass**2, vmass*vwidth )
      endif
      do mu = 0,3
         vc(mu+3) = dcmplx(0d0,0d0)
      enddo
      if (ncart.eq.0) then
         vc(3) = d
      else
         vc(ncart+3) = -d
      endif
c
      vc(1) = dcmplx(p(0),p(3))*nsv
      vc(2) = dcmplx(p(1),p(2))*nsv
c
      return
      end
