c
c in this file leptonic tensors needed for qq -> qq ZZ, ZZ -> 2l 2v 
c and ZZ -> 4l and ZZ -> 2l 2q are computed for specific helicities (h)
c		
c============================================================

      subroutine wwtozzn(q1,q2,P,h,ww_munu,ttype)
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  28) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  13) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer lsign(3:6)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
C GLOBAL VARIABLES
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                          
C  
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0

      ie = sign(1,2-h)
      iu = -1
     
      
	 
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	 
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   )) !vm 
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   )) !vm~ 
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,7))
            CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,8))
            CALL FFV2_1(W(1,5),W(1,7),GC_62,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
            CALL FFV2_0(W(1,6),W(1,9),W(1,8),GC_62,AMP(1))
            CALL FFV2_2(W(1,6),W(1,7),GC_62,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 2
            CALL FFV2_0(W(1,9),W(1,5),W(1,8),GC_62,AMP(2))
            CALL VVS1_3(W(1,1),W(1,2),GC_72,MH,WH,W(1,9))
            CALL FFV2_3(W(1,6),W(1,5),GC_62,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 3
            CALL VVS1_0(W(1,8),W(1,10),W(1,9),GC_81,AMP(3))
            CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,9))
            CALL FFV1_2(W(1,3),W(1,9),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 4
            CALL FFV2_4_0(W(1,11),W(1,4),W(1,10),GC_50,GC_59,AMP(4))
            CALL FFV1_1(W(1,4),W(1,9),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 5
            CALL FFV2_4_0(W(1,3),W(1,11),W(1,10),GC_50,GC_59,AMP(5))
            CALL FFV2_4_2(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 6
            CALL FFV2_4_0(W(1,11),W(1,4),W(1,10),GC_50,GC_59,AMP(6))
            CALL FFV2_4_1(W(1,4),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 7
            CALL FFV2_4_0(W(1,3),W(1,11),W(1,10),GC_50,GC_59,AMP(7))
            CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,11))
            CALL FFV2_1(W(1,4),W(1,2),GC_100,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 8
            CALL FFV2_0(W(1,11),W(1,7),W(1,10),GC_62,AMP(8))
            CALL FFV2_2(W(1,6),W(1,2),GC_100,ZERO,ZERO,W(1,9))
            CALL FFV2_3(W(1,11),W(1,4),GC_100,MW,WW,W(1,12))
C     Amplitude(s) for diagram number 9
            CALL FFV2_0(W(1,9),W(1,5),W(1,12),GC_100,AMP(9))
            CALL FFV2_2(W(1,11),W(1,2),GC_100,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
            CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(10))
C     Amplitude(s) for diagram number 11
            CALL VVV1_0(W(1,12),W(1,2),W(1,10),GC_53,AMP(11))
            CALL FFV2_1(W(1,5),W(1,1),GC_100,ZERO,ZERO,W(1,12))
            CALL FFV2_3(W(1,6),W(1,12),GC_100,MW,WW,W(1,13))
C     Amplitude(s) for diagram number 12
            CALL FFV2_0(W(1,3),W(1,7),W(1,13),GC_100,AMP(12))
            CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 13
            CALL FFV1_0(W(1,9),W(1,12),W(1,11),GC_3,AMP(13))
C     Amplitude(s) for diagram number 14
            CALL FFV2_4_0(W(1,9),W(1,12),W(1,8),GC_50,GC_59,AMP(14))
C     Amplitude(s) for diagram number 15
            CALL VVV1_0(W(1,11),W(1,13),W(1,2),GC_4,AMP(15))
            CALL FFV2_1(W(1,12),W(1,2),GC_100,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 16
            CALL FFV2_0(W(1,6),W(1,4),W(1,8),GC_62,AMP(16))
C     Amplitude(s) for diagram number 17
            CALL VVV1_0(W(1,13),W(1,2),W(1,8),GC_53,AMP(17))
            CALL FFV2_1(W(1,7),W(1,1),GC_100,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 18
            CALL FFV2_4_0(W(1,3),W(1,13),W(1,10),GC_50,GC_59,AMP(18))
            CALL VVV1_2(W(1,1),W(1,10),GC_53,MW,WW,W(1,13))
C     Amplitude(s) for diagram number 19
            CALL FFV2_0(W(1,3),W(1,7),W(1,13),GC_100,AMP(19))
            CALL VVV1_3(W(1,11),W(1,1),GC_4,MW,WW,W(1,7))
C     Amplitude(s) for diagram number 20
            CALL FFV2_0(W(1,9),W(1,5),W(1,7),GC_100,AMP(20))
            CALL FFV2_2(W(1,9),W(1,1),GC_100,ZERO,ZERO,W(1,3))
C     Amplitude(s) for diagram number 21
            CALL FFV2_0(W(1,3),W(1,5),W(1,8),GC_62,AMP(21))
            CALL VVV1_2(W(1,1),W(1,8),GC_53,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 22
            CALL FFV2_0(W(1,9),W(1,5),W(1,3),GC_100,AMP(22))
C     Amplitude(s) for diagram number 23
            CALL VVVV5_0(W(1,11),W(1,1),W(1,2),W(1,10),GC_57,AMP(23))
C     Amplitude(s) for diagram number 24
            CALL VVV1_0(W(1,7),W(1,2),W(1,10),GC_53,AMP(24))
C     Amplitude(s) for diagram number 25
            CALL VVV1_0(W(1,11),W(1,13),W(1,2),GC_4,AMP(25))
C     Amplitude(s) for diagram number 26
            CALL VVVV2_0(W(1,1),W(1,2),W(1,8),W(1,10),GC_36,AMP(26))
C     Amplitude(s) for diagram number 27
            CALL VVV1_0(W(1,3),W(1,2),W(1,10),GC_53,AMP(27))
C     Amplitude(s) for diagram number 28
            CALL VVV1_0(W(1,13),W(1,2),W(1,8),GC_53,AMP(28))
            
            
            if(higgs_only) then
               
               ww_munu(mu,nu) = -amp(3) !H->ZZ  graph only
               
            else          
               ww_munu(mu,nu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &              -AMP(   6)-AMP(   7)-AMP(   8)-AMP(   9)-AMP(  10)
     &              -AMP(  11)-AMP(  12)-AMP(  13)-AMP(  14)-AMP(  15)
     &              -AMP(  16)-AMP(  17)-AMP(  18)-AMP(  19)-AMP(  20)
     &              -AMP(  21)-AMP(  22)-AMP(  23)-AMP(  24)-AMP(  25)
     &              -AMP(  26)-AMP(  27)-AMP(  28)
               
            endif
            
         ENDDO
      ENDDO
      
      END
      
c ------------------------------------------------------------	
              
      subroutine WWtoLLN(idb,h,Q,v,wll,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c  OUPTPUT: wll(mu,nu)  lepton tensor for w w--> vm vm~ 
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wll(0:3,0:3)
      integer h,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lup_loc(6),lum_loc(6)
      double precision qu_loc(0:4)
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                            
C ----------
C BEGIN CODE
C ----------
c
        if (ttype.eq.1) then
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)
           qu_loc(:) = qu_born(:)
        elseif (ttype.eq.3) then
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    q2(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      endif
             
      DO MU = 0,3
         DO NU = 0,3
            CALL OXXXXX_5(P(0,3   ),ZERO ,-1,+1,W(1,3   ))	 
            CALL IXXXXX_5(P(0,4   ),ZERO ,+1,-1,W(1,4   )) 
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            
            CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_0(W(1,4),W(1,3),W(1,5),GC_62,AMP(1))
            CALL FFV2_1(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_0(W(1,4),W(1,5),W(1,2),GC_100,AMP(2))
            
            wll(mu,nu) = -AMP(   1)-AMP(   2)
	 enddo                  !nu
      enddo                     !mu
      end
      
c ------------------------------------------------------------	

      subroutine vto4ln(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer ttype,h

	call Zto4ln(P,h,z4l,ttype)
	call Ato4ln(P,h,a4l,ttype)	
        z4l=dcmplx(0d0,0d0)
	end
		
c ------------------------------------------------------------	
c ------------------------------------------------------------	
   
      subroutine Zto4LN(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   4) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"

c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6) 
  
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = -1

 
       do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo


      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,-ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,+ie,+1,W(1,3   ))       
         CALL OXXXXX_5(P(0,4   ),ZERO ,+iu,+1,W(1,4   ))       
         CALL IXXXXX_5(P(0,5   ),ZERO ,-iu,-1,W(1,5   )) 
         CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))
         CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,6))
         CALL FFV2_1(W(1,4),W(1,6),GC_62,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
         CALL FFV2_0(W(1,5),W(1,7),W(1,1),GC_62,AMP(1))
         CALL FFV2_2(W(1,5),W(1,6),GC_62,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
         CALL FFV2_0(W(1,7),W(1,4),W(1,1),GC_62,AMP(2))
         CALL FFV2_3(W(1,5),W(1,4),GC_62,MZ,WZ,W(1,7))
         CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
         CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_50,GC_59,AMP(3))
         CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 4
         CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_50,GC_59,AMP(4))
         
         z(  mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)
      enddo
      
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))
      
      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4LN(P,h,a,ttype)
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   6) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      INTEGER h,ie,iu,ttype
      complex*16 a(0:5)
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"

c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      a(:) = 0d0

      ie = sign(1,2-h)
      iu = -1

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
 
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,-ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,+ie,+1,W(1,3   ))       
         CALL OXXXXX_5(P(0,4   ),ZERO ,+iu,+1,W(1,4   ))       
         CALL IXXXXX_5(P(0,5   ),ZERO ,-iu,-1,W(1,5   )) 
         CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))
         CALL FFV2_3(W(1,5),W(1,4),GC_62,MZ,WZ,W(1,6))
         CALL FFV2_4_2(W(1,2),W(1,6),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
         CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(1))
         CALL FFV2_4_1(W(1,3),W(1,6),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
         CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(2))
         a( mu) = +AMP(   1)+AMP(   2)
         
      enddo   
      
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))
      
      
      return
      END
      

c ------------------------------------------------------------	

      subroutine vvtozzn(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
	call AAtoZZN(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZZN(q1,q2,P,h,az(0,0),ttype)
	call AZtoZZN(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZZN(q1,q2,P,h,zz(0,0),ttype)
		
      end
		
      
c ------------------------------------------------------------	
       
      subroutine AAtoZZN(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   6) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  9) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C    
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
c                                                                          
C ----------
C BEGIN CODE
C ----------

      ie = sign(1,2-h)
      iu = -1
      

   
      DO MU = 0,3
         DO NU = 0,3
            
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))	
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  ))    
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
            CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
            CALL FFV2_3(W(1,6),W(1,5),GC_62,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
            CALL FFV2_4_0(W(1,7),W(1,8),W(1,9),GC_50,GC_59,AMP(1))
            CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,6),W(1,4),W(1,9),GC_50,GC_59,AMP(2))
            CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,6))
            CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 3
            CALL FFV2_4_0(W(1,7),W(1,6),W(1,9),GC_50,GC_59,AMP(3))
            CALL FFV1_1(W(1,6),W(1,2),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 4
            CALL FFV2_4_0(W(1,3),W(1,5),W(1,9),GC_50,GC_59,AMP(4))
            CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 5
            CALL FFV2_4_0(W(1,5),W(1,4),W(1,9),GC_50,GC_59,AMP(5))
            CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 6
            CALL FFV2_4_0(W(1,3),W(1,5),W(1,9),GC_50,GC_59,AMP(6))
            
            aa(mu,nu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &           -AMP(   6)
            
         enddo
      enddo
      
      end	
      			
c ------------------------------------------------------------
	
       
      subroutine AZtoZZN(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  10) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  13) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ie = sign(1,2-h)
      iu = -1


      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))		 
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
            CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,8))
            CALL FFV2_3(W(1,6),W(1,5),GC_62,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
            CALL FFV2_4_0(W(1,7),W(1,8),W(1,9),GC_50,GC_59,AMP(1))
            CALL FFV2_1(W(1,5),W(1,2),GC_62,ZERO,ZERO,W(1,10))
            CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,11))
C     Amplitude(s) for diagram number 2
            CALL FFV2_0(W(1,6),W(1,10),W(1,11),GC_62,AMP(2))
            CALL FFV2_2(W(1,6),W(1,2),GC_62,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,12),W(1,5),W(1,11),GC_62,AMP(3))
            CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 4
            CALL FFV2_4_0(W(1,11),W(1,4),W(1,9),GC_50,GC_59,AMP(4))
            CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,11))
            CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
            CALL FFV2_4_0(W(1,7),W(1,11),W(1,9),GC_50,GC_59,AMP(5))
            CALL FFV2_4_3(W(1,3),W(1,11),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 6
            CALL FFV2_0(W(1,6),W(1,10),W(1,13),GC_62,AMP(6))
C     Amplitude(s) for diagram number 7
            CALL FFV2_0(W(1,12),W(1,5),W(1,13),GC_62,AMP(7))
            CALL FFV2_4_1(W(1,11),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 8
            CALL FFV2_4_0(W(1,3),W(1,13),W(1,9),GC_50,GC_59,AMP(8))
            CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 9
            CALL FFV2_4_0(W(1,13),W(1,4),W(1,9),GC_50,GC_59,AMP(9))
            CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
            CALL FFV2_4_0(W(1,3),W(1,13),W(1,9),GC_50,GC_59,AMP(10))
            
            az(mu,nu) =  -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &           -AMP(   6)-AMP(   7)-AMP(   8)-AMP(   9)-AMP(  10)
            
         enddo
      enddo	
      
      END

c ------------------------------------------------------------	
c       
      subroutine ZZtoZZN(q1,q2,P,h,zz,ttype)
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e- vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  23) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  14) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
C GLOBAL VARIABLES
      include "coupl.inc"
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = -1

 	
       
      DO MU = 0,3
         DO NU = 0,3
            
            CALL IXXXXX_5(P(0,3   ),ZERO ,-ie,-1,W(1,3   ))	
            CALL OXXXXX_5(P(0,4   ),ZERO ,+ie,+1,W(1,4   ))	
            CALL OXXXXX_5(P(0,5   ),ZERO ,+iu,+1,W(1,5   ))	
            CALL IXXXXX_5(P(0,6   ),ZERO ,-iu,-1,W(1,6   ))	
            CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL VVS1_3(W(1,1),W(1,2),GC_81,MH,WH,W(1,7))
            CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,8))
            CALL FFV2_3(W(1,6),W(1,5),GC_62,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
            CALL VVS1_0(W(1,8),W(1,9),W(1,7),GC_81,AMP(1))
            CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,7))
            CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_50,GC_59,AMP(2))
            CALL FFV2_1(W(1,5),W(1,2),GC_62,ZERO,ZERO,W(1,11))
            CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,6),W(1,11),W(1,12),GC_62,AMP(3))
            CALL FFV2_2(W(1,6),W(1,2),GC_62,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
            CALL FFV2_0(W(1,13),W(1,5),W(1,12),GC_62,AMP(4))
            CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 5
            CALL FFV2_4_0(W(1,12),W(1,4),W(1,9),GC_50,GC_59,AMP(5))
            CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,12))
            CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
            CALL FFV2_4_0(W(1,7),W(1,12),W(1,9),GC_50,GC_59,AMP(6))
            CALL FFV2_4_3(W(1,3),W(1,12),GC_50,GC_59,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 7
            CALL FFV2_0(W(1,6),W(1,11),W(1,14),GC_62,AMP(7))
C     Amplitude(s) for diagram number 8
            CALL FFV2_0(W(1,13),W(1,5),W(1,14),GC_62,AMP(8))
            CALL FFV2_4_1(W(1,12),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 9
            CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_50,GC_59,AMP(9))
            CALL FFV2_1(W(1,5),W(1,1),GC_62,ZERO,ZERO,W(1,14))
            CALL FFV2_3(W(1,6),W(1,14),GC_62,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 10
            CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(10))
C     Amplitude(s) for diagram number 11
            CALL FFV2_4_0(W(1,3),W(1,10),W(1,12),GC_50,GC_59,AMP(11))
C     Amplitude(s) for diagram number 12
            CALL FFV2_0(W(1,13),W(1,14),W(1,8),GC_62,AMP(12))
            CALL FFV2_1(W(1,14),W(1,2),GC_62,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 13
            CALL FFV2_0(W(1,6),W(1,12),W(1,8),GC_62,AMP(13))
            CALL FFV2_2(W(1,6),W(1,1),GC_62,ZERO,ZERO,W(1,12))
            CALL FFV2_3(W(1,12),W(1,5),GC_62,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 14
            CALL FFV2_4_0(W(1,7),W(1,4),W(1,14),GC_50,GC_59,AMP(14))
C     Amplitude(s) for diagram number 15
            CALL FFV2_4_0(W(1,3),W(1,10),W(1,14),GC_50,GC_59,AMP(15))
C     Amplitude(s) for diagram number 16
            CALL FFV2_0(W(1,12),W(1,11),W(1,8),GC_62,AMP(16))
            CALL FFV2_2(W(1,12),W(1,2),GC_62,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 17
            CALL FFV2_0(W(1,14),W(1,5),W(1,8),GC_62,AMP(17))
            CALL FFV2_4_2(W(1,7),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
            CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(18))
            CALL FFV2_4_1(W(1,10),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 19
            CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_50,GC_59,AMP(19))
            CALL FFV2_1(W(1,11),W(1,1),GC_62,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 20
            CALL FFV2_0(W(1,6),W(1,14),W(1,8),GC_62,AMP(20))
            CALL FFV2_2(W(1,13),W(1,1),GC_62,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 21
            CALL FFV2_0(W(1,14),W(1,5),W(1,8),GC_62,AMP(21))
            CALL VVS1_3(W(1,1),W(1,8),GC_81,MH,WH,W(1,14))
C     Amplitude(s) for diagram number 22
            CALL VVS1_0(W(1,2),W(1,9),W(1,14),GC_81,AMP(22))
            CALL VVS1_3(W(1,1),W(1,9),GC_81,MH,WH,W(1,14))
C     Amplitude(s) for diagram number 23
            CALL VVS1_0(W(1,2),W(1,8),W(1,14),GC_81,AMP(23))
            
            if (higgs_only) then
               zz(mu,mu) = -amp(1) !H->ZZ  graph only
            else   
               zz(mu,nu)= -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &              -AMP(   6)-AMP(   7)-AMP(   8)-AMP(   9)-AMP(  10)
     &              -AMP(  11)-AMP(  12)-AMP(  13)-AMP(  14)-AMP(  15)
     &              -AMP(  16)-AMP(  17)-AMP(  18)-AMP(  19)-AMP(  20)
     &              -AMP(  21)-AMP(  22)-AMP(  23)
               
            endif  
            
         enddo
      enddo

      END
c ------------------------------------------------------------	

      subroutine vvtolln(idb,h,Q,v,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

        integer idb
        real*8 q(0:3), v(0:3,4)
        complex*16 aa(0:3,0:3)
        complex*16 az(0:3,0:3)
        complex*16 za(0:3,0:3)
        complex*16 zz(0:3,0:3)
	integer mu,nu
        integer h,ttype

	call ZZtoLLN(idb,h,Q,v,zz,ttype)
		
	do mu = 0,3
	   do nu = 0,3
	      aa(mu,nu) = 0d0
	      az(mu,nu) = 0d0
	      za(mu,nu) = 0d0
	   enddo
	enddo   	
		
	end
		
c ------------------------------------------------------------	
       
      subroutine ZZtoLLN(idb,h,Q,v,zz,ttype)
   
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> vm vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lup_loc(6),lum_loc(6)
      double precision qu_loc(0:4)
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C  
C                                                                          
C ----------
C BEGIN CODE
C ----------   
c
        if (ttype.eq.1) then
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)
           qu_loc(:) = qu_born(:)
        elseif (ttype.eq.3) then
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   
  
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    q2(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
	    p(mu,3) = v(mu,3)
	    p(mu,4) = v(mu,4)
         enddo
      endif
 
 
      DO MU = 0,3
         DO NU = 0,3
            CALL OXXXXX_5(P(0,3   ),ZERO ,-1,+1,W(1,3   ))        
            CALL IXXXXX_5(P(0,4   ),ZERO ,+1,-1,W(1,4   )) 
            CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL FFV2_1(W(1,3),W(1,1),GC_62,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_0(W(1,4),W(1,5),W(1,2),GC_62,AMP(1))
            CALL FFV2_2(W(1,4),W(1,1),GC_62,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_0(W(1,5),W(1,3),W(1,2),GC_62,AMP(2))
            
            zz(mu,nu)  = -AMP(   1)-AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end
c ==================================================
      subroutine WWtoZZ(q1,q2,P,h,ww_munu,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  49) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  15) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'

C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0
      
      ie = sign(1,2-h)
      iu = (-1)**(h+1)
            
      DO MU = 0,3
         DO NU = 0,3
      
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))   
      CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
      CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1_2(W(1,5),W(1,7),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(1))
      CALL FFV1_1(W(1,6),W(1,7),GC_3,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,5),W(1,10),W(1,8),GC_3,AMP(2))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,11))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_50,GC_59,AMP(3))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,5),W(1,10),W(1,11),GC_50,GC_59,AMP(4))
      CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,10))
      CALL FFV2_4_2(W(1,5),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_3,AMP(5))
      CALL FFV2_4_1(W(1,6),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,12),W(1,8),GC_3,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,9),W(1,6),W(1,11),GC_50,GC_59,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,5),W(1,12),W(1,11),GC_50,GC_59,AMP(8))
      CALL VVS1_3(W(1,1),W(1,2),GC_72,MH,WH,W(1,12))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_50,GC_59,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 9
      CALL VVS1_0(W(1,11),W(1,9),W(1,12),GC_81,AMP(9))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,12))
      CALL FFV1_2(W(1,3),W(1,7),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,13),W(1,4),W(1,12),GC_3,AMP(10))
      CALL FFV1_1(W(1,4),W(1,7),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,3),W(1,14),W(1,12),GC_3,AMP(11))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,9),GC_50,GC_59,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_50,GC_59,AMP(13))
      CALL FFV2_4_2(W(1,3),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,14),W(1,4),W(1,12),GC_3,AMP(14))
      CALL FFV2_4_1(W(1,4),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,13),W(1,12),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,13),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,13))
      CALL FFV2_1(W(1,4),W(1,2),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV2_0(W(1,13),W(1,14),W(1,9),GC_62,AMP(18))
      CALL FFV2_1(W(1,6),W(1,2),GC_100,ZERO,ZERO,W(1,10))
      CALL FFV2_3(W(1,13),W(1,4),GC_100,MW,WW,W(1,7))
C     Amplitude(s) for diagram number 19
      CALL FFV2_0(W(1,5),W(1,10),W(1,7),GC_100,AMP(19))
      CALL FFV2_2(W(1,13),W(1,2),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,15),W(1,4),W(1,12),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL VVV1_0(W(1,12),W(1,7),W(1,2),GC_4,AMP(21))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_50,GC_59,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL VVV1_0(W(1,7),W(1,2),W(1,9),GC_53,AMP(23))
      CALL FFV2_2(W(1,5),W(1,1),GC_100,ZERO,ZERO,W(1,7))
      CALL FFV2_3(W(1,7),W(1,6),GC_100,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 24
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_0(W(1,7),W(1,10),W(1,11),GC_62,AMP(25))
      CALL FFV2_2(W(1,7),W(1,2),GC_100,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,4),W(1,6),W(1,8),GC_3,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,4),W(1,6),W(1,11),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(29))
      CALL FFV2_1(W(1,14),W(1,1),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,3),W(1,15),W(1,12),GC_3,AMP(30))
      CALL VVV1_3(W(1,12),W(1,1),GC_4,MW,WW,W(1,4))
C     Amplitude(s) for diagram number 31
      CALL FFV2_0(W(1,3),W(1,14),W(1,4),GC_100,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_50,GC_59,AMP(32))
      CALL VVV1_2(W(1,1),W(1,9),GC_53,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 33
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(33))
      CALL FFV2_1(W(1,10),W(1,1),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,5),W(1,14),W(1,8),GC_3,AMP(34))
      CALL VVV1_3(W(1,8),W(1,1),GC_4,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 35
      CALL FFV2_0(W(1,5),W(1,10),W(1,3),GC_100,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,11),GC_50,GC_59,AMP(36))
      CALL VVV1_2(W(1,1),W(1,11),GC_53,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 37
      CALL FFV2_0(W(1,5),W(1,10),W(1,14),GC_100,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL VVVV2_0(W(1,8),W(1,12),W(1,1),W(1,2),GC_5,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL VVV1_0(W(1,12),W(1,3),W(1,2),GC_4,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL VVV1_0(W(1,8),W(1,4),W(1,2),GC_4,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL VVVV5_0(W(1,8),W(1,1),W(1,2),W(1,9),GC_57,AMP(41))
C     Amplitude(s) for diagram number 42
      CALL VVV1_0(W(1,3),W(1,2),W(1,9),GC_53,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(43))
C     Amplitude(s) for diagram number 44
      CALL VVVV5_0(W(1,12),W(1,1),W(1,2),W(1,11),GC_57,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL VVV1_0(W(1,12),W(1,14),W(1,2),GC_4,AMP(45))
C     Amplitude(s) for diagram number 46
      CALL VVV1_0(W(1,4),W(1,2),W(1,11),GC_53,AMP(46))
C     Amplitude(s) for diagram number 47
      CALL VVVV2_0(W(1,1),W(1,2),W(1,11),W(1,9),GC_36,AMP(47))
C     Amplitude(s) for diagram number 48
      CALL VVV1_0(W(1,14),W(1,2),W(1,9),GC_53,AMP(48))
C     Amplitude(s) for diagram number 49
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(49))

      if(higgs_only) then

         ww_munu(mu,nu) = amp(37)    !H->ZZ  graph only
      
      else   

      
       WW_MUNU(MU,NU) = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)+AMP(41)+AMP(42)+AMP(43)+AMP(44)
     $ +AMP(45)+AMP(46)+AMP(47)+AMP(48)+AMP(49)

      endif
     
            ENDDO
      ENDDO

      END
c ------------------------------------------------------------	

    
c ------------------------------------------------------------	
c
      subroutine WWtoLL(idb,idl,h,Q,v,wll,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: wll(mu,nu)  lepton tensor for w w--> l+l-  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> l+ l-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wll(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif
         	     
      DO MU = 0,3
         DO NU = 0,3
             if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   ))              
            endif
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            
            CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,3),W(1,4),W(1,5),GC_3,AMP(1))
            CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,3),W(1,4),W(1,5),GC_50,GC_59,AMP(2))
            CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,5),W(1,4),W(1,2),GC_100,AMP(3))
            
            wll(mu,nu) =+AMP(1)+AMP(2)+AMP(3)
            
	 enddo                  !nu
      enddo                     !mu
      
      end
      
c ------------------------------------------------------------	
       
       
   
c ------------------------------------------------------------	

      subroutine vvtozz(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
      	call AAtoZZ(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZZ(q1,q2,P,h,az(0,0),ttype)
	call AZtoZZ(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZZ(q1,q2,P,h,zz(0,0),ttype)
		
      end
		
c ------------------------------------------------------------	
       
      subroutine AAtoZZ(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      aa(:,:) = 0d0

      IF (HIGGS_ONLY) RETURN

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
      


      DO MU = 0,3
         DO NU = 0,3
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      
      CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
      CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  ))      
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_50,GC_59,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV1_2(W(1,5),W(1,2),GC_3,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,11),W(1,6),W(1,13),GC_50,GC_59,AMP(4))
      CALL FFV1_1(W(1,6),W(1,2),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,13),GC_50,GC_59,AMP(6))
      CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,11),W(1,6),W(1,15),GC_50,GC_59,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,15),GC_50,GC_59,AMP(14))
      CALL FFV1_1(W(1,13),W(1,2),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_3,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_4_3(W(1,15),W(1,6),GC_50,GC_59,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_3,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,15),W(1,14),W(1,13),GC_50,GC_59,AMP(22))
      CALL FFV1_2(W(1,15),W(1,2),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_3,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_4_0(W(1,16),W(1,6),W(1,13),GC_50,GC_59,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_3,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_4_3(W(1,5),W(1,16),GC_50,GC_59,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_3,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_4_0(W(1,11),W(1,16),W(1,13),GC_50,GC_59,AMP(30))
      CALL FFV1_1(W(1,16),W(1,2),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_50,GC_59,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_3,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_4_0(W(1,17),W(1,6),W(1,13),GC_50,GC_59,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_50,GC_59,AMP(40))
      
      aa(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &             +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)

	   enddo
        enddo
	
	end
	
				
c ------------------------------------------------------------
	
       
      subroutine AZtoZZ(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      az(:,:) = 0d0

      if (higgs_only) return 

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
      
      
      DO MU = 0,3
         DO NU = 0,3
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      
      CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_50,GC_59,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV2_4_2(W(1,5),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,11),W(1,6),W(1,13),GC_50,GC_59,AMP(4))
      CALL FFV2_4_1(W(1,6),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,13),GC_50,GC_59,AMP(6))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_3,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,11),W(1,6),W(1,15),GC_50,GC_59,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_3,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_4_0(W(1,5),W(1,14),W(1,15),GC_50,GC_59,AMP(14))
      CALL FFV2_4_1(W(1,13),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_3,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_4_3(W(1,15),W(1,6),GC_50,GC_59,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_3,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,15),W(1,14),W(1,13),GC_50,GC_59,AMP(22))
      CALL FFV2_4_2(W(1,15),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_3,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_4_0(W(1,16),W(1,6),W(1,13),GC_50,GC_59,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_3,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_4_3(W(1,5),W(1,16),GC_50,GC_59,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_3,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_4_0(W(1,11),W(1,16),W(1,13),GC_50,GC_59,AMP(30))
      CALL FFV2_4_1(W(1,16),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_50,GC_59,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_3,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_4_0(W(1,17),W(1,6),W(1,13),GC_50,GC_59,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_3,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,13),GC_50,GC_59,AMP(40))
            
      az(mu,nu) = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)
	
	  enddo
       enddo	

      END

c ------------------------------------------------------------	
c       
      subroutine ZZtoZZ(q1,q2,P,h,zz,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=  43) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

      
      DO MU = 0,3
         DO NU = 0,3
      CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
      CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
      CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
      CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
      
      CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 
      CALL VVS1_3(W(1,1),W(1,2),GC_81,MH,WH,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,8))
      CALL FFV2_4_3(W(1,5),W(1,6),GC_50,GC_59,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS1_0(W(1,8),W(1,9),W(1,7),GC_81,AMP(1))
      CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,10))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,7),W(1,10),W(1,11),GC_3,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_50,GC_59,AMP(3))
      CALL FFV2_4_2(W(1,5),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,12))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_3,AMP(4))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,12),W(1,6),W(1,14),GC_50,GC_59,AMP(5))
      CALL FFV2_4_1(W(1,6),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_3,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,14),GC_50,GC_59,AMP(7))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,14),W(1,4),W(1,11),GC_3,AMP(8))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(9))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,7),W(1,14),W(1,11),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,7),W(1,14),W(1,9),GC_50,GC_59,AMP(11))
      CALL FFV1P0_3(W(1,3),W(1,14),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 12
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_3,AMP(12))
      CALL FFV2_4_3(W(1,3),W(1,14),GC_50,GC_59,MZ,WZ,W(1,16))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,12),W(1,6),W(1,16),GC_50,GC_59,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_3,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_4_0(W(1,5),W(1,15),W(1,16),GC_50,GC_59,AMP(15))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 16
      CALL FFV1_0(W(1,3),W(1,16),W(1,11),GC_3,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_4_2(W(1,5),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,16),W(1,6),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV1_0(W(1,7),W(1,4),W(1,14),GC_3,AMP(18))
      CALL FFV2_4_3(W(1,16),W(1,6),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,13),GC_50,GC_59,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,3),W(1,10),W(1,14),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,13),GC_50,GC_59,AMP(21))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,16),W(1,15),W(1,13),GC_3,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL FFV2_4_0(W(1,16),W(1,15),W(1,8),GC_50,GC_59,AMP(23))
      CALL FFV2_4_2(W(1,16),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 24
      CALL FFV1_0(W(1,14),W(1,6),W(1,13),GC_3,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_4_0(W(1,14),W(1,6),W(1,8),GC_50,GC_59,AMP(25))
      CALL FFV2_4_1(W(1,6),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
      CALL FFV1P0_3(W(1,5),W(1,14),GC_3,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,7),W(1,4),W(1,16),GC_3,AMP(26))
      CALL FFV2_4_3(W(1,5),W(1,14),GC_50,GC_59,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 27
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV1_0(W(1,3),W(1,10),W(1,16),GC_3,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,17),GC_50,GC_59,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,12),W(1,14),W(1,13),GC_3,AMP(30))
C     Amplitude(s) for diagram number 31
      CALL FFV2_4_0(W(1,12),W(1,14),W(1,8),GC_50,GC_59,AMP(31))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 32
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_3,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,8),GC_50,GC_59,AMP(33))
      CALL FFV2_4_2(W(1,7),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,17),W(1,4),W(1,11),GC_3,AMP(34))
C     Amplitude(s) for diagram number 35
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,9),GC_50,GC_59,AMP(35))
      CALL FFV2_4_1(W(1,10),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 36
      CALL FFV1_0(W(1,3),W(1,17),W(1,11),GC_3,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,9),GC_50,GC_59,AMP(37))
      CALL FFV2_4_2(W(1,12),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 38
      CALL FFV1_0(W(1,17),W(1,6),W(1,13),GC_3,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL FFV2_4_0(W(1,17),W(1,6),W(1,8),GC_50,GC_59,AMP(39))
      CALL FFV2_4_1(W(1,15),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_3,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL FFV2_4_0(W(1,5),W(1,17),W(1,8),GC_50,GC_59,AMP(41))
      CALL VVS1_3(W(1,1),W(1,8),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 42
      CALL VVS1_0(W(1,2),W(1,9),W(1,17),GC_81,AMP(42))
      CALL VVS1_3(W(1,1),W(1,9),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 43
      CALL VVS1_0(W(1,2),W(1,8),W(1,17),GC_81,AMP(43))

      if (higgs_only) then !H->ZZ
      
      zz(mu,nu) = amp(31) + amp(36) + amp(43)! amp(36.43) are t-channel

      else
      
      zz(mu,nu)  = +AMP(1)+AMP(2)+AMP(3)+AMP(4)+AMP(5)+AMP(6)+AMP(7)+AMP(8)
     $ +AMP(9)+AMP(10)+AMP(11)+AMP(12)+AMP(13)+AMP(14)+AMP(15)+AMP(16)
     $ +AMP(17)+AMP(18)+AMP(19)+AMP(20)+AMP(21)+AMP(22)+AMP(23)
     $ +AMP(24)+AMP(25)+AMP(26)+AMP(27)+AMP(28)+AMP(29)+AMP(30)
     $ +AMP(31)+AMP(32)+AMP(33)+AMP(34)+AMP(35)+AMP(36)+AMP(37)
     $ +AMP(38)+AMP(39)+AMP(40)+AMP(41)+AMP(42)+AMP(43)
 
      endif !honly

	  enddo
       enddo

      END
c ------------------------------------------------------------	

 
c ------------------------------------------------------------	

        subroutine vvtoll(idb,idl,h,Q,v,aa,az,za,zz,ttype)
	
        IMPLICIT NONE

        integer idb,idl,h
        integer ttype
        real*8 q(0:3), v(0:3,4)
        complex*16 aa(0:3,0:3)
        complex*16 az(0:3,0:3)
        complex*16 za(0:3,0:3)
        complex*16 zz(0:3,0:3)
      
        aa(:,:) = 0d0
        az(:,:) = 0d0
        za(:,:) = 0d0
        zz(:,:) = 0d0

	call AAtoLL(idb,idl,Q,v,h,aa(0,0),ttype)
	call AZtoLL(idb,idl,Q,v,h,az(0,0),ttype)
	call ZAtoLL(idb,idl,Q,v,h,za(0,0),ttype) 
        call ZZtoLL(idb,idl,Q,v,h,zz(0,0),ttype)

	end
	
c ------------------------------------------------------------	

       
      subroutine AAtoLL(idb,idl,Q,v,h,aa,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a a --> l+l-  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C    
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      aa(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif
      
      DO MU = 0,3
         DO NU = 0,3
            if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))	     
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  )) 
            
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_3,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_3,AMP(2))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	
       
      subroutine AZtoLL(idb,idl,Q,v,h,az,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> l+l-  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 az(0:3,0:3)
      integer il,h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      az(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif
	 
	             
      DO MU = 0,3
         DO NU = 0,3
            if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_4_0(W(1,5),W(1,4),W(1,2),GC_50,GC_59,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,3),W(1,5),W(1,2),GC_50,GC_59,AMP(2))
            
            az(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	
       
      subroutine ZAtoLL(idb,idl,Q,v,h,za,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> l+l-  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z a -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 za(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      za(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif

      	     
      DO MU = 0,3
         DO NU = 0,3
             if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif
            CALL VCARTX_5(Q1(0),zmass ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zero  ,zero , NU,-1,W(1,2   )) 
            CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_3,AMP(1))
            CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_3,AMP(2))
            
            za(mu,nu) = +AMP(   1)+AMP(   2)
            
 	 enddo                  !nu
      enddo                     !mu
      
      end



c ------------------------------------------------------------	
       
      subroutine ZZtoLL(idb,idl,Q,v,h,zz,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c	    idl = 1	 l is e
c	    idl = 2	 l is mu
c  OUPTPUT: aa(mu,nu)  lepton tensor for z z --> l+l-  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb,idl
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      if (idl.eq.1) then 
         il = ie
      else
         il = iu
      endif   
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
	    if (idl.eq.1) then
                q2(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
	        q2(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
	    if (idl.eq.1) then
            	q1(mu) = qe_loc(mu)-q(mu)
		p(mu,3) = v(mu,1)
		p(mu,4) = v(mu,2)
	    else
            	q1(mu) = qu_loc(mu)-q(mu)
		p(mu,3) = v(mu,3)
		p(mu,4) = v(mu,4)
	    endif
         enddo
      endif

      	     
      DO MU = 0,3
         DO NU = 0,3
             if (lswitch) then
               if (idl.eq.1) then
                  do i = 1,6
                     w(i,3) = lep_loc(i)
                     w(i,4) = lem_loc(i)
                  enddo
               else
                  do i = 1,6
                     w(i,3) = lup_loc(i)
                     w(i,4) = lum_loc(i)
                  enddo
               endif
            else	 
               CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
               CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            endif
            CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_4_0(W(1,5),W(1,4),W(1,2),GC_50,GC_59,AMP(1))
            CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_4_0(W(1,3),W(1,5),W(1,2),GC_50,GC_59,AMP(2))
            
            zz(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	



c ------------------------------------------------------------	

      subroutine vto4l(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer h,ie,iu
      integer ttype

      z4l(:) = 0d0
      a4l(:) = 0d0

	call Zto4l(P,h,z4l,ttype)
	call Ato4l(P,h,a4l,ttype)
		
	end
		
c ------------------------------------------------------------	
c ------------------------------------------------------------	
   
      subroutine Zto4L(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)

C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

                   
      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
      CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
      CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
      CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
      CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
      
      CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))
      CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,4),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
      CALL FFV2_4_0(W(1,7),W(1,5),W(1,1),GC_50,GC_59,AMP(1))
      CALL FFV1_1(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,4),W(1,7),W(1,1),GC_50,GC_59,AMP(2))
      CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,4),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,6),W(1,5),W(1,1),GC_50,GC_59,AMP(3))
      CALL FFV2_4_1(W(1,5),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
      CALL FFV2_4_0(W(1,4),W(1,6),W(1,1),GC_50,GC_59,AMP(4))
      CALL FFV1P0_3(W(1,4),W(1,5),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
      CALL FFV2_4_0(W(1,7),W(1,3),W(1,1),GC_50,GC_59,AMP(5))
      CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
      CALL FFV2_4_0(W(1,2),W(1,7),W(1,1),GC_50,GC_59,AMP(6))
      CALL FFV2_4_3(W(1,4),W(1,5),GC_50,GC_59,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
      CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_50,GC_59,AMP(7))
      CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_50,GC_59,AMP(8))
      z(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &             -AMP(   6)-AMP(   7)-AMP(   8)
      enddo
             
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))

      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4L(P,h,a,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- mu+ mu-  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 a(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      a(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
      CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
      CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
      CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
      CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
        
      CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))
      CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,4),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,5),W(1,1),GC_3,AMP(1))
      CALL FFV1_1(W(1,5),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,4),W(1,7),W(1,1),GC_3,AMP(2))
      CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,4),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,6),W(1,5),W(1,1),GC_3,AMP(3))
      CALL FFV2_4_1(W(1,5),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,4),W(1,6),W(1,1),GC_3,AMP(4))
      CALL FFV1P0_3(W(1,4),W(1,5),GC_3,ZERO,ZERO,W(1,6))
      CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,7),W(1,3),W(1,1),GC_3,AMP(5))
      CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,2),W(1,7),W(1,1),GC_3,AMP(6))
      CALL FFV2_4_3(W(1,4),W(1,5),GC_50,GC_59,MZ,WZ,W(1,7))
      CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(7))
      CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(8))

      a(mu) =-AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &            -AMP(   6)-AMP(   7)-AMP(   8)
     
      enddo   
     
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))

      return
      END
      
c ------------------------------------------------------------------
      subroutine WWtoZD(q1,q2,P,h,ww_munu,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  50) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  15) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'

C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
  

      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 

      CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
      CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
      
      CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1_2(W(1,5),W(1,7),GC_1,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_1,AMP(1))
      CALL FFV1_1(W(1,6),W(1,7),GC_1,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,5),W(1,10),W(1,8),GC_1,AMP(2))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,11))
C     Amplitude(s) for diagram number 3
      CALL FFV2_3_0(W(1,9),W(1,6),W(1,11),GC_50,GC_58,AMP(3))
C     Amplitude(s) for diagram number 4
      CALL FFV2_3_0(W(1,5),W(1,10),W(1,11),GC_50,GC_58,AMP(4))
      CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,10))
      CALL FFV2_3_2(W(1,5),W(1,10),GC_50,GC_58,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_1,AMP(5))
      CALL FFV2_3_1(W(1,6),W(1,10),GC_50,GC_58,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,12),W(1,8),GC_1,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_3_0(W(1,9),W(1,6),W(1,11),GC_50,GC_58,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_3_0(W(1,5),W(1,12),W(1,11),GC_50,GC_58,AMP(8))
      CALL VVS1_3(W(1,1),W(1,2),GC_72,MH,WH,W(1,12))
      CALL FFV2_3_3(W(1,5),W(1,6),GC_50,GC_58,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 9
      CALL VVS1_0(W(1,11),W(1,9),W(1,12),GC_81,AMP(9))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,12))
      CALL FFV1_2(W(1,3),W(1,7),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,13),W(1,4),W(1,12),GC_3,AMP(10))
      CALL FFV1_1(W(1,4),W(1,7),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,3),W(1,14),W(1,12),GC_3,AMP(11))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,9),GC_50,GC_59,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_50,GC_59,AMP(13))
      CALL FFV2_4_2(W(1,3),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,14),W(1,4),W(1,12),GC_3,AMP(14))
      CALL FFV2_4_1(W(1,4),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,13),W(1,12),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,13),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,13))
      CALL FFV2_1(W(1,4),W(1,2),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV2_0(W(1,13),W(1,14),W(1,9),GC_62,AMP(18))
      CALL FFV2_1(W(1,6),W(1,2),GC_100,ZERO,ZERO,W(1,10))
      CALL FFV2_3(W(1,13),W(1,4),GC_100,MW,WW,W(1,7))
C     Amplitude(s) for diagram number 19
      CALL FFV2_0(W(1,5),W(1,10),W(1,7),GC_100,AMP(19))
      CALL FFV2_2(W(1,13),W(1,2),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,15),W(1,4),W(1,12),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL VVV1_0(W(1,12),W(1,7),W(1,2),GC_4,AMP(21))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_50,GC_59,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL VVV1_0(W(1,7),W(1,2),W(1,9),GC_53,AMP(23))
      CALL FFV2_2(W(1,5),W(1,1),GC_100,ZERO,ZERO,W(1,7))
      CALL FFV2_3(W(1,7),W(1,6),GC_100,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 24
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,10),W(1,8),GC_2,AMP(25))
C     Amplitude(s) for diagram number 26
      CALL FFV2_5_0(W(1,7),W(1,10),W(1,11),GC_51,GC_58,AMP(26))
      CALL FFV2_2(W(1,7),W(1,2),GC_100,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,4),W(1,6),W(1,8),GC_1,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_3_0(W(1,4),W(1,6),W(1,11),GC_50,GC_58,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(30))
      CALL FFV2_1(W(1,14),W(1,1),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,3),W(1,15),W(1,12),GC_3,AMP(31))
      CALL VVV1_3(W(1,12),W(1,1),GC_4,MW,WW,W(1,4))
C     Amplitude(s) for diagram number 32
      CALL FFV2_0(W(1,3),W(1,14),W(1,4),GC_100,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_50,GC_59,AMP(33))
      CALL VVV1_2(W(1,1),W(1,9),GC_53,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 34
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(34))
      CALL FFV2_1(W(1,10),W(1,1),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,5),W(1,14),W(1,8),GC_1,AMP(35))
      CALL VVV1_3(W(1,8),W(1,1),GC_4,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 36
      CALL FFV2_0(W(1,5),W(1,10),W(1,3),GC_100,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_3_0(W(1,5),W(1,14),W(1,11),GC_50,GC_58,AMP(37))
      CALL VVV1_2(W(1,1),W(1,11),GC_53,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 38
      CALL FFV2_0(W(1,5),W(1,10),W(1,14),GC_100,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL VVVV2_0(W(1,8),W(1,12),W(1,1),W(1,2),GC_5,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL VVV1_0(W(1,12),W(1,3),W(1,2),GC_4,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL VVV1_0(W(1,8),W(1,4),W(1,2),GC_4,AMP(41))
C     Amplitude(s) for diagram number 42
      CALL VVVV5_0(W(1,8),W(1,1),W(1,2),W(1,9),GC_57,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL VVV1_0(W(1,3),W(1,2),W(1,9),GC_53,AMP(43))
C     Amplitude(s) for diagram number 44
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL VVVV5_0(W(1,12),W(1,1),W(1,2),W(1,11),GC_57,AMP(45))
C     Amplitude(s) for diagram number 46
      CALL VVV1_0(W(1,12),W(1,14),W(1,2),GC_4,AMP(46))
C     Amplitude(s) for diagram number 47
      CALL VVV1_0(W(1,4),W(1,2),W(1,11),GC_53,AMP(47))
C     Amplitude(s) for diagram number 48
      CALL VVVV2_0(W(1,1),W(1,2),W(1,11),W(1,9),GC_36,AMP(48))
C     Amplitude(s) for diagram number 49
      CALL VVV1_0(W(1,14),W(1,2),W(1,9),GC_53,AMP(49))
C     Amplitude(s) for diagram number 50
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(50))

      if(higgs_only) then

         ww_munu(mu,nu) = amp(9)    !H->ZZ  graph only
      
      else    

      WW_munu(MU,NU) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &             +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     &             +AMP(  41)+AMP(  42)+AMP(  43)+AMP(  44)+AMP(  45)
     &             +AMP(  46)+AMP(  47)+AMP(  48)+AMP(  49)+AMP(  50)

     
      endif
     
            ENDDO
      ENDDO


      END
		
c ------------------------------------------------------------	
      subroutine WWtoZU(q1,q2,P,h,ww_munu,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  50) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  15) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww_munu(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'

C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      ww_munu(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
  

      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 

            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,7))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1_2(W(1,5),W(1,7),GC_2,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_2,AMP(1))
      CALL FFV1_1(W(1,6),W(1,7),GC_2,ZERO,ZERO,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,5),W(1,10),W(1,8),GC_2,AMP(2))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,11))
C     Amplitude(s) for diagram number 3
      CALL FFV2_5_0(W(1,9),W(1,6),W(1,11),GC_51,GC_58,AMP(3))
C     Amplitude(s) for diagram number 4
      CALL FFV2_5_0(W(1,5),W(1,10),W(1,11),GC_51,GC_58,AMP(4))
      CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,10))
      CALL FFV2_5_2(W(1,5),W(1,10),GC_51,GC_58,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,9),W(1,6),W(1,8),GC_2,AMP(5))
      CALL FFV2_5_1(W(1,6),W(1,10),GC_51,GC_58,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,12),W(1,8),GC_2,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_5_0(W(1,9),W(1,6),W(1,11),GC_51,GC_58,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_5_0(W(1,5),W(1,12),W(1,11),GC_51,GC_58,AMP(8))
      CALL VVS1_3(W(1,1),W(1,2),GC_72,MH,WH,W(1,12))
      CALL FFV2_5_3(W(1,5),W(1,6),GC_51,GC_58,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 9
      CALL VVS1_0(W(1,11),W(1,9),W(1,12),GC_81,AMP(9))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,12))
      CALL FFV1_2(W(1,3),W(1,7),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,13),W(1,4),W(1,12),GC_3,AMP(10))
      CALL FFV1_1(W(1,4),W(1,7),GC_3,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,3),W(1,14),W(1,12),GC_3,AMP(11))
C     Amplitude(s) for diagram number 12
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,9),GC_50,GC_59,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV2_4_0(W(1,3),W(1,14),W(1,9),GC_50,GC_59,AMP(13))
      CALL FFV2_4_2(W(1,3),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,14),W(1,4),W(1,12),GC_3,AMP(14))
      CALL FFV2_4_1(W(1,4),W(1,10),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,13),W(1,12),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,13),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,13))
      CALL FFV2_1(W(1,4),W(1,2),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV2_0(W(1,13),W(1,14),W(1,9),GC_62,AMP(18))
      CALL FFV2_2(W(1,5),W(1,2),GC_100,ZERO,ZERO,W(1,10))
      CALL FFV2_3(W(1,13),W(1,4),GC_100,MW,WW,W(1,7))
C     Amplitude(s) for diagram number 19
      CALL FFV2_0(W(1,10),W(1,6),W(1,7),GC_100,AMP(19))
      CALL FFV2_2(W(1,13),W(1,2),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,15),W(1,4),W(1,12),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL VVV1_0(W(1,12),W(1,7),W(1,2),GC_4,AMP(21))
C     Amplitude(s) for diagram number 22
      CALL FFV2_4_0(W(1,15),W(1,4),W(1,9),GC_50,GC_59,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL VVV1_0(W(1,7),W(1,2),W(1,9),GC_53,AMP(23))
      CALL FFV2_1(W(1,6),W(1,1),GC_100,ZERO,ZERO,W(1,7))
      CALL FFV2_3(W(1,5),W(1,7),GC_100,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 24
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,10),W(1,7),W(1,8),GC_1,AMP(25))
C     Amplitude(s) for diagram number 26
      CALL FFV2_3_0(W(1,10),W(1,7),W(1,11),GC_50,GC_58,AMP(26))
      CALL FFV2_1(W(1,7),W(1,2),GC_100,ZERO,ZERO,W(1,4))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,5),W(1,4),W(1,8),GC_2,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_5_0(W(1,5),W(1,4),W(1,11),GC_51,GC_58,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(30))
      CALL FFV2_1(W(1,14),W(1,1),GC_100,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,3),W(1,15),W(1,12),GC_3,AMP(31))
      CALL VVV1_3(W(1,12),W(1,1),GC_4,MW,WW,W(1,4))
C     Amplitude(s) for diagram number 32
      CALL FFV2_0(W(1,3),W(1,14),W(1,4),GC_100,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,9),GC_50,GC_59,AMP(33))
      CALL VVV1_2(W(1,1),W(1,9),GC_53,MW,WW,W(1,15))
C     Amplitude(s) for diagram number 34
      CALL FFV2_0(W(1,3),W(1,14),W(1,15),GC_100,AMP(34))
      CALL FFV2_2(W(1,10),W(1,1),GC_100,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,14),W(1,6),W(1,8),GC_2,AMP(35))
      CALL VVV1_3(W(1,8),W(1,1),GC_4,MW,WW,W(1,3))
C     Amplitude(s) for diagram number 36
      CALL FFV2_0(W(1,10),W(1,6),W(1,3),GC_100,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_5_0(W(1,14),W(1,6),W(1,11),GC_51,GC_58,AMP(37))
      CALL VVV1_2(W(1,1),W(1,11),GC_53,MW,WW,W(1,14))
C     Amplitude(s) for diagram number 38
      CALL FFV2_0(W(1,10),W(1,6),W(1,14),GC_100,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL VVVV2_0(W(1,8),W(1,12),W(1,1),W(1,2),GC_5,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL VVV1_0(W(1,12),W(1,3),W(1,2),GC_4,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL VVV1_0(W(1,8),W(1,4),W(1,2),GC_4,AMP(41))
C     Amplitude(s) for diagram number 42
      CALL VVVV5_0(W(1,8),W(1,1),W(1,2),W(1,9),GC_57,AMP(42))
C     Amplitude(s) for diagram number 43
      CALL VVV1_0(W(1,3),W(1,2),W(1,9),GC_53,AMP(43))
C     Amplitude(s) for diagram number 44
      CALL VVV1_0(W(1,8),W(1,15),W(1,2),GC_4,AMP(44))
C     Amplitude(s) for diagram number 45
      CALL VVVV5_0(W(1,12),W(1,1),W(1,2),W(1,11),GC_57,AMP(45))
C     Amplitude(s) for diagram number 46
      CALL VVV1_0(W(1,12),W(1,14),W(1,2),GC_4,AMP(46))
C     Amplitude(s) for diagram number 47
      CALL VVV1_0(W(1,4),W(1,2),W(1,11),GC_53,AMP(47))
C     Amplitude(s) for diagram number 48
      CALL VVVV2_0(W(1,1),W(1,2),W(1,11),W(1,9),GC_36,AMP(48))
C     Amplitude(s) for diagram number 49
      CALL VVV1_0(W(1,14),W(1,2),W(1,9),GC_53,AMP(49))
C     Amplitude(s) for diagram number 50
      CALL VVV1_0(W(1,15),W(1,2),W(1,11),GC_53,AMP(50))

      if(higgs_only) then

         ww_munu(mu,nu) = amp(9)    !H->ZZ  graph only
      
      else    

      WW_munu(MU,NU) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &             +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     &             +AMP(  41)+AMP(  42)+AMP(  43)+AMP(  44)+AMP(  45)
     &             +AMP(  46)+AMP(  47)+AMP(  48)+AMP(  49)+AMP(  50)

     
      endif
     
            ENDDO
      ENDDO


      END
		
c ------------------------------------------------------------	
c
c
      subroutine WWtoDD(idb,h,Q,v,wqq,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c  OUPTPUT: wqq(mu,nu)  lepton tensor for w w--> b~ b  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> b~ b
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wqq(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

      if (ttype.eq.1) then
         lep_loc(:) = lep_born(:,h)
         lem_loc(:) = lem_born(:,h)
         lup_loc(:) = lup_born(:,h)
         lum_loc(:) = lum_born(:,h)
         
         qe_loc(:) = qe_born(:)
         qu_loc(:) = qu_born(:)
         
      elseif (ttype.eq.3) then
         lep_loc(:) = lep_real(:,h)
         lem_loc(:) = lem_real(:,h)
         lup_loc(:) = lup_real(:,h)
         lum_loc(:) = lum_real(:,h)
         
         qe_loc(:) = qe_real(:)
         qu_loc(:) = qu_real(:)
      else
         stop 'bad ttype for leptonic tensors'
      endif   

      iu = (-1)**(h+1)
      
c     Quark pair always second decay
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
              
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+iu,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-iu,+1,W(1,4   ))              
            
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,3),W(1,4),W(1,5),GC_1,AMP(1))
            CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_3_0(W(1,3),W(1,4),W(1,5),GC_50,GC_58,AMP(2))
            CALL FFV2_2(W(1,3),W(1,1),GC_100,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,5),W(1,4),W(1,2),GC_100,AMP(3))
            
            wqq(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)
            
	 enddo                  !nu
      enddo                     !mu
      end
c ----------------------------------------
c ----------------------------------------

      subroutine WWtoUU(idb,h,Q,v,wqq,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = W+ momentum
c           idb = 2      Q = q2 = W- momentum
c  OUPTPUT: wqq(mu,nu)  lepton tensor for w w--> t~ t  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w- -> t~ t
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 wqq(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

      if (ttype.eq.1) then
         lep_loc(:) = lep_born(:,h)
         lem_loc(:) = lem_born(:,h)
         lup_loc(:) = lup_born(:,h)
         lum_loc(:) = lum_born(:,h)
         
         qe_loc(:) = qe_born(:)
         qu_loc(:) = qu_born(:)
         
      elseif (ttype.eq.3) then
         lep_loc(:) = lep_real(:,h)
         lem_loc(:) = lem_real(:,h)
         lup_loc(:) = lup_real(:,h)
         lum_loc(:) = lum_real(:,h)
         
         qe_loc(:) = qe_real(:)
         qu_loc(:) = qu_real(:)
      else
         stop 'bad ttype for leptonic tensors'
      endif   
      
c     ie = sign(1,2-h)
      iu = (-1)**(h+1)
      
c     Quark pair always second decay
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
      
                
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+iu,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-iu,+1,W(1,4   ))              
            
            CALL VCARTX_5(Q1(0),WMASS ,wwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),WMASS ,wwidth, NU,-1,W(1,2   )) 
            CALL VVV1P0_1(W(1,1),W(1,2),GC_4,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,3),W(1,4),W(1,5),GC_2,AMP(1))
            CALL VVV1_3(W(1,1),W(1,2),GC_53,MZ,WZ,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_5_0(W(1,3),W(1,4),W(1,5),GC_51,GC_58,AMP(2))
            CALL FFV2_1(W(1,4),W(1,1),GC_100,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 3
            CALL FFV2_0(W(1,3),W(1,5),W(1,2),GC_100,AMP(3))
            
            wqq(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)
            
	 enddo !nu
      enddo !mu

      end

c ------------------------------------------------------------	
c ------------------------------------------------------------	

      subroutine vvtozd(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
      	call AAtoZD(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZD(q1,q2,P,h,az(0,0),ttype)
	call AZtoZD(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZD(q1,q2,P,h,zz(0,0),ttype)
		
      end
c ------------------------------------------------------------	

      subroutine vvtozu(q1,q2,P,h,aa,az,za,zz,ttype)
	
      IMPLICIT NONE

      include '../higgs_graphs.h'

      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      complex*16 az(0:3,0:3)
      complex*16 za(0:3,0:3)
      complex*16 zz(0:3,0:3)
      integer h
      integer ttype

      aa(:,:) = 0d0
      az(:,:) = 0d0
      za(:,:) = 0d0
      zz(:,:) = 0d0
      
      if (.not.higgs_only) then 
      	call AAtoZU(q1,q2,P,h,aa(0,0),ttype)
	call AZtoZU(q1,q2,P,h,az(0,0),ttype)
	call AZtoZU(q2,q1,P,h,za(0,0),ttype)
      endif  
      call ZZtoZU(q1,q2,P,h,zz(0,0),ttype)
		
      end
		
c ------------------------------------------------------------	
       
      subroutine AAtoZD(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      aa(:,:) = 0d0

      IF (HIGGS_ONLY) RETURN

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
     
            
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
            
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  ))
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_3_3(W(1,5),W(1,6),GC_50,GC_58,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV1_2(W(1,5),W(1,2),GC_1,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_1,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_3_0(W(1,11),W(1,6),W(1,13),GC_50,GC_58,AMP(4))
      CALL FFV1_1(W(1,6),W(1,2),GC_1,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_1,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_3_0(W(1,5),W(1,14),W(1,13),GC_50,GC_58,AMP(6))
      CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_1,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_3_0(W(1,11),W(1,6),W(1,15),GC_50,GC_58,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_1,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_3_0(W(1,5),W(1,14),W(1,15),GC_50,GC_58,AMP(14))
      CALL FFV1_1(W(1,13),W(1,2),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_1,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_1,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_3_3(W(1,15),W(1,6),GC_50,GC_58,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_1,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_3_0(W(1,15),W(1,14),W(1,13),GC_50,GC_58,AMP(22))
      CALL FFV1_2(W(1,15),W(1,2),GC_1,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_1,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_3_0(W(1,16),W(1,6),W(1,13),GC_50,GC_58,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_1,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_1,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_3_3(W(1,5),W(1,16),GC_50,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_1,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_3_0(W(1,11),W(1,16),W(1,13),GC_50,GC_58,AMP(30))
      CALL FFV1_1(W(1,16),W(1,2),GC_1,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_1,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,13),GC_50,GC_58,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_1,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_1,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_3_0(W(1,17),W(1,6),W(1,13),GC_50,GC_58,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_1,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_1,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,13),GC_50,GC_58,AMP(40))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &           +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &           +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &           +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &           +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &           +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &           +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &           +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
         enddo
      enddo
      
      end
      
c ------------------------------------------------------------	
       
      subroutine AAtoZU(q1,q2,P,h,aa,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
c
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------
      
      aa(:,:) = 0d0

      IF (HIGGS_ONLY) RETURN

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
     
                  
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
            
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  ))

            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV1_1(W(1,4),W(1,2),GC_3,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_5_3(W(1,5),W(1,6),GC_51,GC_58,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV1_2(W(1,5),W(1,2),GC_2,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_2,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_5_0(W(1,11),W(1,6),W(1,13),GC_51,GC_58,AMP(4))
      CALL FFV1_1(W(1,6),W(1,2),GC_2,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_2,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_5_0(W(1,5),W(1,14),W(1,13),GC_51,GC_58,AMP(6))
      CALL FFV1_2(W(1,7),W(1,2),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV1_2(W(1,3),W(1,2),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_2,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_5_0(W(1,11),W(1,6),W(1,15),GC_51,GC_58,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_2,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_5_0(W(1,5),W(1,14),W(1,15),GC_51,GC_58,AMP(14))
      CALL FFV1_1(W(1,13),W(1,2),GC_3,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_2,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_2,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_5_3(W(1,15),W(1,6),GC_51,GC_58,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_2,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_5_0(W(1,15),W(1,14),W(1,13),GC_51,GC_58,AMP(22))
      CALL FFV1_2(W(1,15),W(1,2),GC_2,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_2,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_5_0(W(1,16),W(1,6),W(1,13),GC_51,GC_58,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_2,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_2,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_5_3(W(1,5),W(1,16),GC_51,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_2,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_5_0(W(1,11),W(1,16),W(1,13),GC_51,GC_58,AMP(30))
      CALL FFV1_1(W(1,16),W(1,2),GC_2,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_2,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,13),GC_51,GC_58,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_2,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_2,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_5_0(W(1,17),W(1,6),W(1,13),GC_51,GC_58,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_2,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_2,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,13),GC_51,GC_58,AMP(40))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &           +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &           +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &           +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &           +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &           +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &           +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &           +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
         enddo
      enddo
      
      end
      
				
c ------------------------------------------------------------
	
       
      subroutine AZtoZD(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      az(:,:) = 0d0

      if (higgs_only) return 

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

        
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
            
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_3_3(W(1,5),W(1,6),GC_50,GC_58,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV2_3_2(W(1,5),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_1,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_3_0(W(1,11),W(1,6),W(1,13),GC_50,GC_58,AMP(4))
      CALL FFV2_3_1(W(1,6),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_1,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_3_0(W(1,5),W(1,14),W(1,13),GC_50,GC_58,AMP(6))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_1,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_3_0(W(1,11),W(1,6),W(1,15),GC_50,GC_58,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_1,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_3_0(W(1,5),W(1,14),W(1,15),GC_50,GC_58,AMP(14))
      CALL FFV2_4_1(W(1,13),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_1,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_1,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_3_3(W(1,15),W(1,6),GC_50,GC_58,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_1,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_3_0(W(1,15),W(1,14),W(1,13),GC_50,GC_58,AMP(22))
      CALL FFV2_3_2(W(1,15),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_1,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_3_0(W(1,16),W(1,6),W(1,13),GC_50,GC_58,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_1,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_1,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_3_3(W(1,5),W(1,16),GC_50,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_1,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_3_0(W(1,11),W(1,16),W(1,13),GC_50,GC_58,AMP(30))
      CALL FFV2_3_1(W(1,16),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_1,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,13),GC_50,GC_58,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_1,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_1,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_3_0(W(1,17),W(1,6),W(1,13),GC_50,GC_58,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_1,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_1,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,13),GC_50,GC_58,AMP(40))
            
      az(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &             +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     
	
	  enddo
       enddo	

      END
c ------------------------------------------------------------
	
       
      subroutine AZtoZU(q1,q2,P,h,az,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=  40) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 az(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
c
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      az(:,:) = 0d0

      if (higgs_only) return 

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

    
        
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 

            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
            CALL FFV1_2(W(1,3),W(1,1),GC_3,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,8))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL FFV1_0(W(1,7),W(1,8),W(1,9),GC_3,AMP(1))
      CALL FFV2_5_3(W(1,5),W(1,6),GC_51,GC_58,MZ,WZ,W(1,10))
C     Amplitude(s) for diagram number 2
      CALL FFV2_4_0(W(1,7),W(1,8),W(1,10),GC_50,GC_59,AMP(2))
      CALL FFV2_5_2(W(1,5),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,11))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 3
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_2,AMP(3))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV2_5_0(W(1,11),W(1,6),W(1,13),GC_51,GC_58,AMP(4))
      CALL FFV2_5_1(W(1,6),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_2,AMP(5))
C     Amplitude(s) for diagram number 6
      CALL FFV2_5_0(W(1,5),W(1,14),W(1,13),GC_51,GC_58,AMP(6))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 7
      CALL FFV1_0(W(1,13),W(1,4),W(1,9),GC_3,AMP(7))
C     Amplitude(s) for diagram number 8
      CALL FFV2_4_0(W(1,13),W(1,4),W(1,10),GC_50,GC_59,AMP(8))
      CALL FFV1_1(W(1,4),W(1,1),GC_3,ZERO,ZERO,W(1,13))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 9
      CALL FFV1_0(W(1,7),W(1,13),W(1,9),GC_3,AMP(9))
C     Amplitude(s) for diagram number 10
      CALL FFV2_4_0(W(1,7),W(1,13),W(1,10),GC_50,GC_59,AMP(10))
      CALL FFV1P0_3(W(1,3),W(1,13),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 11
      CALL FFV1_0(W(1,11),W(1,6),W(1,12),GC_2,AMP(11))
      CALL FFV2_4_3(W(1,3),W(1,13),GC_50,GC_59,MZ,WZ,W(1,15))
C     Amplitude(s) for diagram number 12
      CALL FFV2_5_0(W(1,11),W(1,6),W(1,15),GC_51,GC_58,AMP(12))
C     Amplitude(s) for diagram number 13
      CALL FFV1_0(W(1,5),W(1,14),W(1,12),GC_2,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV2_5_0(W(1,5),W(1,14),W(1,15),GC_51,GC_58,AMP(14))
      CALL FFV2_4_1(W(1,13),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 15
      CALL FFV1_0(W(1,3),W(1,15),W(1,9),GC_3,AMP(15))
C     Amplitude(s) for diagram number 16
      CALL FFV2_4_0(W(1,3),W(1,15),W(1,10),GC_50,GC_59,AMP(16))
      CALL FFV1_2(W(1,5),W(1,1),GC_2,ZERO,ZERO,W(1,15))
      CALL FFV1P0_3(W(1,15),W(1,6),GC_2,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 17
      CALL FFV1_0(W(1,7),W(1,4),W(1,13),GC_3,AMP(17))
      CALL FFV2_5_3(W(1,15),W(1,6),GC_51,GC_58,MZ,WZ,W(1,12))
C     Amplitude(s) for diagram number 18
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,12),GC_50,GC_59,AMP(18))
C     Amplitude(s) for diagram number 19
      CALL FFV1_0(W(1,3),W(1,8),W(1,13),GC_3,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,12),GC_50,GC_59,AMP(20))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,12))
C     Amplitude(s) for diagram number 21
      CALL FFV1_0(W(1,15),W(1,14),W(1,12),GC_2,AMP(21))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV2_5_0(W(1,15),W(1,14),W(1,13),GC_51,GC_58,AMP(22))
      CALL FFV2_5_2(W(1,15),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 23
      CALL FFV1_0(W(1,16),W(1,6),W(1,12),GC_2,AMP(23))
C     Amplitude(s) for diagram number 24
      CALL FFV2_5_0(W(1,16),W(1,6),W(1,13),GC_51,GC_58,AMP(24))
      CALL FFV1_1(W(1,6),W(1,1),GC_2,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,5),W(1,16),GC_2,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 25
      CALL FFV1_0(W(1,7),W(1,4),W(1,15),GC_3,AMP(25))
      CALL FFV2_5_3(W(1,5),W(1,16),GC_51,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 26
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(26))
C     Amplitude(s) for diagram number 27
      CALL FFV1_0(W(1,3),W(1,8),W(1,15),GC_3,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV2_4_0(W(1,3),W(1,8),W(1,17),GC_50,GC_59,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV1_0(W(1,11),W(1,16),W(1,12),GC_2,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV2_5_0(W(1,11),W(1,16),W(1,13),GC_51,GC_58,AMP(30))
      CALL FFV2_5_1(W(1,16),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 31
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_2,AMP(31))
C     Amplitude(s) for diagram number 32
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,13),GC_51,GC_58,AMP(32))
      CALL FFV1_2(W(1,7),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 33
      CALL FFV1_0(W(1,17),W(1,4),W(1,9),GC_3,AMP(33))
C     Amplitude(s) for diagram number 34
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,10),GC_50,GC_59,AMP(34))
      CALL FFV1_1(W(1,8),W(1,1),GC_3,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 35
      CALL FFV1_0(W(1,3),W(1,17),W(1,9),GC_3,AMP(35))
C     Amplitude(s) for diagram number 36
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,10),GC_50,GC_59,AMP(36))
      CALL FFV1_2(W(1,11),W(1,1),GC_2,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 37
      CALL FFV1_0(W(1,17),W(1,6),W(1,12),GC_2,AMP(37))
C     Amplitude(s) for diagram number 38
      CALL FFV2_5_0(W(1,17),W(1,6),W(1,13),GC_51,GC_58,AMP(38))
      CALL FFV1_1(W(1,14),W(1,1),GC_2,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 39
      CALL FFV1_0(W(1,5),W(1,17),W(1,12),GC_2,AMP(39))
C     Amplitude(s) for diagram number 40
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,13),GC_51,GC_58,AMP(40))
           
      az(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &             +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     
	
	  enddo
       enddo	

      END

c ------------------------------------------------------------	
c       
      subroutine ZZtoZD(q1,q2,P,h,zz,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=  43) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)


      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 

            CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL VVS1_3(W(1,1),W(1,2),GC_81,MH,WH,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,8))
      CALL FFV2_3_3(W(1,5),W(1,6),GC_50,GC_58,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS1_0(W(1,8),W(1,9),W(1,7),GC_81,AMP(1))
      CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,10))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,7),W(1,10),W(1,11),GC_3,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_50,GC_59,AMP(3))
      CALL FFV2_3_2(W(1,5),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,12))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_1,AMP(4))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV2_3_0(W(1,12),W(1,6),W(1,14),GC_50,GC_58,AMP(5))
      CALL FFV2_3_1(W(1,6),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_1,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_3_0(W(1,5),W(1,15),W(1,14),GC_50,GC_58,AMP(7))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,14),W(1,4),W(1,11),GC_3,AMP(8))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(9))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,7),W(1,14),W(1,11),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,7),W(1,14),W(1,9),GC_50,GC_59,AMP(11))
      CALL FFV1P0_3(W(1,3),W(1,14),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 12
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_1,AMP(12))
      CALL FFV2_4_3(W(1,3),W(1,14),GC_50,GC_59,MZ,WZ,W(1,16))
C     Amplitude(s) for diagram number 13
      CALL FFV2_3_0(W(1,12),W(1,6),W(1,16),GC_50,GC_58,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_1,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_3_0(W(1,5),W(1,15),W(1,16),GC_50,GC_58,AMP(15))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 16
      CALL FFV1_0(W(1,3),W(1,16),W(1,11),GC_3,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_3_2(W(1,5),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,16),W(1,6),GC_1,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV1_0(W(1,7),W(1,4),W(1,14),GC_3,AMP(18))
      CALL FFV2_3_3(W(1,16),W(1,6),GC_50,GC_58,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,13),GC_50,GC_59,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,3),W(1,10),W(1,14),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,13),GC_50,GC_59,AMP(21))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,16),W(1,15),W(1,13),GC_1,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL FFV2_3_0(W(1,16),W(1,15),W(1,8),GC_50,GC_58,AMP(23))
      CALL FFV2_3_2(W(1,16),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 24
      CALL FFV1_0(W(1,14),W(1,6),W(1,13),GC_1,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_3_0(W(1,14),W(1,6),W(1,8),GC_50,GC_58,AMP(25))
      CALL FFV2_3_1(W(1,6),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,14))
      CALL FFV1P0_3(W(1,5),W(1,14),GC_1,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,7),W(1,4),W(1,16),GC_3,AMP(26))
      CALL FFV2_3_3(W(1,5),W(1,14),GC_50,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 27
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV1_0(W(1,3),W(1,10),W(1,16),GC_3,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,17),GC_50,GC_59,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,12),W(1,14),W(1,13),GC_1,AMP(30))
C     Amplitude(s) for diagram number 31
      CALL FFV2_3_0(W(1,12),W(1,14),W(1,8),GC_50,GC_58,AMP(31))
      CALL FFV2_3_1(W(1,14),W(1,2),GC_50,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 32
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_1,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,8),GC_50,GC_58,AMP(33))
      CALL FFV2_4_2(W(1,7),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,17),W(1,4),W(1,11),GC_3,AMP(34))
C     Amplitude(s) for diagram number 35
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,9),GC_50,GC_59,AMP(35))
      CALL FFV2_4_1(W(1,10),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 36
      CALL FFV1_0(W(1,3),W(1,17),W(1,11),GC_3,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,9),GC_50,GC_59,AMP(37))
      CALL FFV2_3_2(W(1,12),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 38
      CALL FFV1_0(W(1,17),W(1,6),W(1,13),GC_1,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL FFV2_3_0(W(1,17),W(1,6),W(1,8),GC_50,GC_58,AMP(39))
      CALL FFV2_3_1(W(1,15),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_1,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL FFV2_3_0(W(1,5),W(1,17),W(1,8),GC_50,GC_58,AMP(41))
      CALL VVS1_3(W(1,1),W(1,8),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 42
      CALL VVS1_0(W(1,2),W(1,9),W(1,17),GC_81,AMP(42))
      CALL VVS1_3(W(1,1),W(1,9),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 43
      CALL VVS1_0(W(1,2),W(1,8),W(1,17),GC_81,AMP(43))

      if (higgs_only) then !H->ZZ
      
      zz(mu,nu) = amp(1) + amp(42) + amp(43)! amp(36.43) are t-channel

      else
      
         zz(mu,nu)  = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &        +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &        +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &        +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &        +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &        +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &        +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &        +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     &        +AMP(  41)+AMP(  42)+AMP(  43)
      
      endif !honly

	  enddo
       enddo

      END
c ------------------------------------------------------------	
c       
      subroutine ZZtoZU(q1,q2,P,h,zz,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=  43) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=  17) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ze_loc(6), zu_loc(6), 
     &               ae_loc(6), au_loc(6) 
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
      include '../higgs_graphs.h'
C  
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

     

      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+ie,-1,W(1,3   ))	 
            CALL OXXXXX_5(P(0,4   ),ZERO ,-ie,+1,W(1,4   ))	 
            CALL IXXXXX_5(P(0,5   ),ZERO ,+iu,-1,W(1,5   ))	 
            CALL OXXXXX_5(P(0,6   ),ZERO ,-iu,+1,W(1,6   ))	 
            
            CALL VCARTX_5(Q1(0),ZMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),ZMASS ,zwidth, NU,-1,W(1,2   )) 
            
            CALL VVS1_3(W(1,1),W(1,2),GC_81,MH,WH,W(1,7))
      CALL FFV2_4_3(W(1,3),W(1,4),GC_50,GC_59,MZ,WZ,W(1,8))
      CALL FFV2_5_3(W(1,5),W(1,6),GC_51,GC_58,MZ,WZ,W(1,9))
C     Amplitude(s) for diagram number 1
      CALL VVS1_0(W(1,8),W(1,9),W(1,7),GC_81,AMP(1))
      CALL FFV2_4_2(W(1,3),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,7))
      CALL FFV2_4_1(W(1,4),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,10))
      CALL FFV1P0_3(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,11))
C     Amplitude(s) for diagram number 2
      CALL FFV1_0(W(1,7),W(1,10),W(1,11),GC_3,AMP(2))
C     Amplitude(s) for diagram number 3
      CALL FFV2_4_0(W(1,7),W(1,10),W(1,9),GC_50,GC_59,AMP(3))
      CALL FFV2_5_2(W(1,5),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,12))
      CALL FFV1P0_3(W(1,7),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 4
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_2,AMP(4))
      CALL FFV2_4_3(W(1,7),W(1,4),GC_50,GC_59,MZ,WZ,W(1,14))
C     Amplitude(s) for diagram number 5
      CALL FFV2_5_0(W(1,12),W(1,6),W(1,14),GC_51,GC_58,AMP(5))
      CALL FFV2_5_1(W(1,6),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,15))
C     Amplitude(s) for diagram number 6
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_2,AMP(6))
C     Amplitude(s) for diagram number 7
      CALL FFV2_5_0(W(1,5),W(1,15),W(1,14),GC_51,GC_58,AMP(7))
      CALL FFV2_4_2(W(1,7),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 8
      CALL FFV1_0(W(1,14),W(1,4),W(1,11),GC_3,AMP(8))
C     Amplitude(s) for diagram number 9
      CALL FFV2_4_0(W(1,14),W(1,4),W(1,9),GC_50,GC_59,AMP(9))
      CALL FFV2_4_1(W(1,4),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,14))
      CALL FFV2_4_2(W(1,3),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 10
      CALL FFV1_0(W(1,7),W(1,14),W(1,11),GC_3,AMP(10))
C     Amplitude(s) for diagram number 11
      CALL FFV2_4_0(W(1,7),W(1,14),W(1,9),GC_50,GC_59,AMP(11))
      CALL FFV1P0_3(W(1,3),W(1,14),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 12
      CALL FFV1_0(W(1,12),W(1,6),W(1,13),GC_2,AMP(12))
      CALL FFV2_4_3(W(1,3),W(1,14),GC_50,GC_59,MZ,WZ,W(1,16))
C     Amplitude(s) for diagram number 13
      CALL FFV2_5_0(W(1,12),W(1,6),W(1,16),GC_51,GC_58,AMP(13))
C     Amplitude(s) for diagram number 14
      CALL FFV1_0(W(1,5),W(1,15),W(1,13),GC_2,AMP(14))
C     Amplitude(s) for diagram number 15
      CALL FFV2_5_0(W(1,5),W(1,15),W(1,16),GC_51,GC_58,AMP(15))
      CALL FFV2_4_1(W(1,14),W(1,2),GC_50,GC_59,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 16
      CALL FFV1_0(W(1,3),W(1,16),W(1,11),GC_3,AMP(16))
C     Amplitude(s) for diagram number 17
      CALL FFV2_4_0(W(1,3),W(1,16),W(1,9),GC_50,GC_59,AMP(17))
      CALL FFV2_5_2(W(1,5),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,16))
      CALL FFV1P0_3(W(1,16),W(1,6),GC_2,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 18
      CALL FFV1_0(W(1,7),W(1,4),W(1,14),GC_3,AMP(18))
      CALL FFV2_5_3(W(1,16),W(1,6),GC_51,GC_58,MZ,WZ,W(1,13))
C     Amplitude(s) for diagram number 19
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,13),GC_50,GC_59,AMP(19))
C     Amplitude(s) for diagram number 20
      CALL FFV1_0(W(1,3),W(1,10),W(1,14),GC_3,AMP(20))
C     Amplitude(s) for diagram number 21
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,13),GC_50,GC_59,AMP(21))
      CALL FFV1P0_3(W(1,3),W(1,4),GC_3,ZERO,ZERO,W(1,13))
C     Amplitude(s) for diagram number 22
      CALL FFV1_0(W(1,16),W(1,15),W(1,13),GC_2,AMP(22))
C     Amplitude(s) for diagram number 23
      CALL FFV2_5_0(W(1,16),W(1,15),W(1,8),GC_51,GC_58,AMP(23))
      CALL FFV2_5_2(W(1,16),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,14))
C     Amplitude(s) for diagram number 24
      CALL FFV1_0(W(1,14),W(1,6),W(1,13),GC_2,AMP(24))
C     Amplitude(s) for diagram number 25
      CALL FFV2_5_0(W(1,14),W(1,6),W(1,8),GC_51,GC_58,AMP(25))
      CALL FFV2_5_1(W(1,6),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,14))
      CALL FFV1P0_3(W(1,5),W(1,14),GC_2,ZERO,ZERO,W(1,16))
C     Amplitude(s) for diagram number 26
      CALL FFV1_0(W(1,7),W(1,4),W(1,16),GC_3,AMP(26))
      CALL FFV2_5_3(W(1,5),W(1,14),GC_51,GC_58,MZ,WZ,W(1,17))
C     Amplitude(s) for diagram number 27
      CALL FFV2_4_0(W(1,7),W(1,4),W(1,17),GC_50,GC_59,AMP(27))
C     Amplitude(s) for diagram number 28
      CALL FFV1_0(W(1,3),W(1,10),W(1,16),GC_3,AMP(28))
C     Amplitude(s) for diagram number 29
      CALL FFV2_4_0(W(1,3),W(1,10),W(1,17),GC_50,GC_59,AMP(29))
C     Amplitude(s) for diagram number 30
      CALL FFV1_0(W(1,12),W(1,14),W(1,13),GC_2,AMP(30))
C     Amplitude(s) for diagram number 31
      CALL FFV2_5_0(W(1,12),W(1,14),W(1,8),GC_51,GC_58,AMP(31))
      CALL FFV2_5_1(W(1,14),W(1,2),GC_51,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 32
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_2,AMP(32))
C     Amplitude(s) for diagram number 33
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,8),GC_51,GC_58,AMP(33))
      CALL FFV2_4_2(W(1,7),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 34
      CALL FFV1_0(W(1,17),W(1,4),W(1,11),GC_3,AMP(34))
C     Amplitude(s) for diagram number 35
      CALL FFV2_4_0(W(1,17),W(1,4),W(1,9),GC_50,GC_59,AMP(35))
      CALL FFV2_4_1(W(1,10),W(1,1),GC_50,GC_59,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 36
      CALL FFV1_0(W(1,3),W(1,17),W(1,11),GC_3,AMP(36))
C     Amplitude(s) for diagram number 37
      CALL FFV2_4_0(W(1,3),W(1,17),W(1,9),GC_50,GC_59,AMP(37))
      CALL FFV2_5_2(W(1,12),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 38
      CALL FFV1_0(W(1,17),W(1,6),W(1,13),GC_2,AMP(38))
C     Amplitude(s) for diagram number 39
      CALL FFV2_5_0(W(1,17),W(1,6),W(1,8),GC_51,GC_58,AMP(39))
      CALL FFV2_5_1(W(1,15),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,17))
C     Amplitude(s) for diagram number 40
      CALL FFV1_0(W(1,5),W(1,17),W(1,13),GC_2,AMP(40))
C     Amplitude(s) for diagram number 41
      CALL FFV2_5_0(W(1,5),W(1,17),W(1,8),GC_51,GC_58,AMP(41))
      CALL VVS1_3(W(1,1),W(1,8),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 42
      CALL VVS1_0(W(1,2),W(1,9),W(1,17),GC_81,AMP(42))
      CALL VVS1_3(W(1,1),W(1,9),GC_81,MH,WH,W(1,17))
C     Amplitude(s) for diagram number 43
      CALL VVS1_0(W(1,2),W(1,8),W(1,17),GC_81,AMP(43))

      if (higgs_only) then !H->ZZ
      
      zz(mu,nu) = amp(1) + amp(42) + amp(43)! amp(36.43) are t-channel

      else
      
         zz(mu,nu)  = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &        +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &        +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &        +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &        +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &        +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &        +AMP(  31)+AMP(  32)+AMP(  33)+AMP(  34)+AMP(  35)
     &        +AMP(  36)+AMP(  37)+AMP(  38)+AMP(  39)+AMP(  40)
     &        +AMP(  41)+AMP(  42)+AMP(  43)
      
      endif !honly

	  enddo
       enddo

      END

c ------------------------------------------------------------	
c ------------------------------------------------------------	

        subroutine vvtoDD(idb,h,Q,v,aa,az,za,zz,ttype)
	
        IMPLICIT NONE

        integer idb,h
        integer ttype
        real*8 q(0:3), v(0:3,4)
        complex*16 aa(0:3,0:3)
        complex*16 az(0:3,0:3)
        complex*16 za(0:3,0:3)
        complex*16 zz(0:3,0:3)
      
        aa(:,:) = 0d0
        az(:,:) = 0d0
        za(:,:) = 0d0
        zz(:,:) = 0d0

	call AAtoDD(idb,Q,v,h,aa(0,0),ttype)
	call AZtoDD(idb,Q,v,h,az(0,0),ttype)
	call ZAtoDD(idb,Q,v,h,za(0,0),ttype) 
        call ZZtoDD(idb,Q,v,h,zz(0,0),ttype)

	end
c ------------------------------------------------------------	

        subroutine vvtoUU(idb,h,Q,v,aa,az,za,zz,ttype)
	
        IMPLICIT NONE

        integer idb,h
        integer ttype
        real*8 q(0:3), v(0:3,4)
        complex*16 aa(0:3,0:3)
        complex*16 az(0:3,0:3)
        complex*16 za(0:3,0:3)
        complex*16 zz(0:3,0:3)
      
        aa(:,:) = 0d0
        az(:,:) = 0d0
        za(:,:) = 0d0
        zz(:,:) = 0d0

	call AAtoUU(idb,Q,v,h,aa(0,0),ttype)
	call AZtoUU(idb,Q,v,h,az(0,0),ttype)
	call ZAtoUU(idb,Q,v,h,za(0,0),ttype) 
        call ZZtoUU(idb,Q,v,h,zz(0,0),ttype)

	end
	
c ------------------------------------------------------------	

       

       
      subroutine AAtoDD(idb,Q,v,h,aa,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a a --> b~ b  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> b~ b
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C    
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      aa(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
	    
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
	
             
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))	     
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  )) 

            CALL FFV1_2(W(1,3),W(1,1),GC_1,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_1,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_1,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_1,AMP(2))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	
      subroutine AAtoUU(idb,Q,v,h,aa,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a a --> t~ t  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a a -> t~ t
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 aa(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C    
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
c      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      aa(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
	    
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
	
             
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))	     
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zero ,zero, MU,-1,W(1,1	  ))	    
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2	  )) 

            CALL FFV1_2(W(1,3),W(1,1),GC_2,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_2,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_2,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_2,AMP(2))
            
            aa(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	
           
      subroutine AZtoDD(idb,Q,v,h,az,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> b~ b  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> b~ b
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 az(0:3,0:3)
      integer il,h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      az(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
            
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
	 
        	             
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL FFV1_2(W(1,3),W(1,1),GC_1,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_3_0(W(1,5),W(1,4),W(1,2),GC_50,GC_58,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_1,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_3_0(W(1,3),W(1,5),W(1,2),GC_50,GC_58,AMP(2))
            
            az(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end
c ------------------------------------------------------------	
       
      subroutine AZtoUU(idb,Q,v,h,az,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> t~ t  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> t~ t
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 az(0:3,0:3)
      integer il,h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      az(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
            
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
	 
        	             
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zero  ,zero, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL FFV1_2(W(1,3),W(1,1),GC_2,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_5_0(W(1,5),W(1,4),W(1,2),GC_51,GC_58,AMP(1))
            CALL FFV1_1(W(1,4),W(1,1),GC_2,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_5_0(W(1,3),W(1,5),W(1,2),GC_51,GC_58,AMP(2))
            
            az(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	
       
      subroutine ZAtoDD(idb,Q,v,h,za,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> b~ b  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z a -> b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 za(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      za(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif

	     
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zmass ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zero  ,zero , NU,-1,W(1,2   )) 

            CALL FFV2_3_2(W(1,3),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_1,AMP(1))
            CALL FFV2_3_1(W(1,4),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_1,AMP(2))
            
            za(mu,nu) = +AMP(   1)+AMP(   2)
            
 	 enddo                  !nu
      enddo                     !mu
      
      end
c ---------------------------------------------------------

      subroutine ZAtoUU(idb,Q,v,h,az,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for a z --> t~ t  
C  
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a z -> t~ t
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS  
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 az(0:3,0:3)
      integer il,h,ie,iu
      integer ttype
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      az(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
            
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif
	 
      	             
      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zmass  ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zero ,zero, NU,-1,W(1,2   )) 

            CALL FFV2_5_2(W(1,3),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV1_0(W(1,5),W(1,4),W(1,2),GC_2,AMP(1))
            CALL FFV2_5_1(W(1,4),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV1_0(W(1,3),W(1,5),W(1,2),GC_2,AMP(2))
            
            az(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	

c ------------------------------------------------------------	
       
      subroutine ZZtoDD(idb,Q,v,h,zz,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for z z --> b~ b  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> b~ b
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif

      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 
 
            CALL FFV2_3_2(W(1,3),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_3_0(W(1,5),W(1,4),W(1,2),GC_50,GC_58,AMP(1))
            CALL FFV2_3_1(W(1,4),W(1,1),GC_50,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_3_0(W(1,3),W(1,5),W(1,2),GC_50,GC_58,AMP(2))
            
            zz(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end
c ------------------------------------------------------------	
       
      subroutine ZZtoUU(idb,Q,v,h,zz,ttype)
C  Input:   Q(*)        one of the two incoming boson momenta 
c           idb = 1      Q = q1 = A(1) momentum
c           idb = 2      Q = q2 = A(2) momentum
c  OUPTPUT: aa(mu,nu)  lepton tensor for z z --> t~ t  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z z -> t~ t
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS=   2) 
      INTEGER    NWAVEFUNCS   
      PARAMETER (NWAVEFUNCS=   5) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      integer idb
      real*8 q(0:3), v(0:3,4), p(0:3,3:4)
      complex*16 zz(0:3,0:3)
      integer h,ie,iu,il
      integer ttype
C  
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu,nu
      real*8 Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors 
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double precision qe_loc(0:4),qu_loc(0:4)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.true.)
C  
C ----------
C BEGIN CODE
C ----------

        if (ttype.eq.1) then
           lep_loc(:) = lep_born(:,h)
           lem_loc(:) = lem_born(:,h)
           lup_loc(:) = lup_born(:,h)
           lum_loc(:) = lum_born(:,h)

           qe_loc(:) = qe_born(:)
           qu_loc(:) = qu_born(:)

        elseif (ttype.eq.3) then
           lep_loc(:) = lep_real(:,h)
           lem_loc(:) = lem_real(:,h)
           lup_loc(:) = lup_real(:,h)
           lum_loc(:) = lum_real(:,h)

           qe_loc(:) = qe_real(:)
           qu_loc(:) = qu_real(:)
        else
         stop 'bad ttype for leptonic tensors'
        endif   

      zz(:,:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
         
      il = iu
      
      if (idb.eq.1) then
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      elseif (idb.eq.2) then
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = qu_loc(mu)-q(mu)
            p(mu,3) = v(mu,3)
            p(mu,4) = v(mu,4)
         enddo
      endif

      DO MU = 0,3
         DO NU = 0,3
            CALL IXXXXX_5(P(0,3   ),ZERO ,+il,-1,W(1,3   ))        
            CALL OXXXXX_5(P(0,4   ),ZERO ,-il,+1,W(1,4   )) 
            
            CALL VCARTX_5(Q1(0),zMASS ,zwidth, MU,-1,W(1,1   ))        
            CALL VCARTX_5(Q2(0),zMASS ,zwidth, NU,-1,W(1,2   )) 

            CALL FFV2_5_2(W(1,3),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 1
            CALL FFV2_5_0(W(1,5),W(1,4),W(1,2),GC_51,GC_58,AMP(1))
            CALL FFV2_5_1(W(1,4),W(1,1),GC_51,GC_58,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 2
            CALL FFV2_5_0(W(1,3),W(1,5),W(1,2),GC_51,GC_58,AMP(2))
            
            zz(mu,nu) = +AMP(   1)+AMP(   2)
            
	 enddo                  !nu
      enddo                     !mu
      
      end

c ------------------------------------------------------------	
c ------------------------------------------------------------	

      subroutine vto4ld(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer h,ie,iu
      integer ttype

      z4l(:) = 0d0
      a4l(:) = 0d0

	call Zto4lD(P,h,z4l,ttype)
	call Ato4lD(P,h,a4l,ttype)
		
	end
		
c ------------------------------------------------------------	
      
      subroutine vto4lU(p,h,a4l,z4l,ttype)
	
      IMPLICIT NONE

      REAL*8 P(0:3,2:5)
      complex*16 a4l(0:5),z4l(0:5)
      integer h,ie,iu
      integer ttype

      z4l(:) = 0d0
      a4l(:) = 0d0

	call Zto4lU(P,h,z4l,ttype)
	call Ato4lU(P,h,a4l,ttype)
		
	end
		
c ------------------------------------------------------------	
c ------------------------------------------------------------	
   
      subroutine Zto4lD(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8 ) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)

C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C  
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)
                       
      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
         CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
         CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
         
         CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))

         CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,4),W(1,6),GC_1,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
         CALL FFV2_3_0(W(1,7),W(1,5),W(1,1),GC_50,GC_58,AMP(1))
         CALL FFV1_1(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
         CALL FFV2_3_0(W(1,4),W(1,7),W(1,1),GC_50,GC_58,AMP(2))
         CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
         CALL FFV2_3_2(W(1,4),W(1,7),GC_50,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
         CALL FFV2_3_0(W(1,6),W(1,5),W(1,1),GC_50,GC_58,AMP(3))
         CALL FFV2_3_1(W(1,5),W(1,7),GC_50,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
         CALL FFV2_3_0(W(1,4),W(1,6),W(1,1),GC_50,GC_58,AMP(4))
         CALL FFV1P0_3(W(1,4),W(1,5),GC_1,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
         CALL FFV2_4_0(W(1,7),W(1,3),W(1,1),GC_50,GC_59,AMP(5))
         CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
         CALL FFV2_4_0(W(1,2),W(1,7),W(1,1),GC_50,GC_59,AMP(6))
         CALL FFV2_3_3(W(1,4),W(1,5),GC_50,GC_58,MZ,WZ,W(1,7))
         CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
         CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_50,GC_59,AMP(7))
         CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
         CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_50,GC_59,AMP(8))
         
         z(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &        -AMP(   6)-AMP(   7)-AMP(   8)
      enddo
      
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))
      
      return
      END
c ------------------------------------------------------------	
   
      subroutine Zto4lU(P,h,z,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8 ) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 z(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)

C GLOBAL VARIABLES
C  
      include "coupl.inc"
   
      logical lswitch
      parameter (lswitch=.false.)
C  
C ----------
C BEGIN CODE
C ----------

      z(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

     
                       
      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
         CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
         CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
         
         CALL VCARTX_5(Q(0),zmass ,zwidth, MU,-1,W(1,1   ))
         CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,4),W(1,6),GC_2,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
         CALL FFV2_5_0(W(1,7),W(1,5),W(1,1),GC_51,GC_58,AMP(1))
         CALL FFV1_1(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
         CALL FFV2_5_0(W(1,4),W(1,7),W(1,1),GC_51,GC_58,AMP(2))
         CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
         CALL FFV2_5_2(W(1,4),W(1,7),GC_51,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
         CALL FFV2_5_0(W(1,6),W(1,5),W(1,1),GC_51,GC_58,AMP(3))
         CALL FFV2_5_1(W(1,5),W(1,7),GC_51,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
         CALL FFV2_5_0(W(1,4),W(1,6),W(1,1),GC_51,GC_58,AMP(4))
         CALL FFV1P0_3(W(1,4),W(1,5),GC_2,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
         CALL FFV2_4_0(W(1,7),W(1,3),W(1,1),GC_50,GC_59,AMP(5))
         CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
         CALL FFV2_4_0(W(1,2),W(1,7),W(1,1),GC_50,GC_59,AMP(6))
         CALL FFV2_5_3(W(1,4),W(1,5),GC_51,GC_58,MZ,WZ,W(1,7))
         CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
         CALL FFV2_4_0(W(1,5),W(1,3),W(1,1),GC_50,GC_59,AMP(7))
         CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
         CALL FFV2_4_0(W(1,2),W(1,5),W(1,1),GC_50,GC_59,AMP(8))
         
         z(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &        -AMP(   6)-AMP(   7)-AMP(   8)
      enddo
      
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))
      
      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4ld(P,h,a,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- b~ b  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 a(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      a(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

           do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
         CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
         CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
         
         CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))
         
         CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,4),W(1,6),GC_1,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
         CALL FFV1_0(W(1,7),W(1,5),W(1,1),GC_1,AMP(1))
         CALL FFV1_1(W(1,5),W(1,6),GC_1,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
         CALL FFV1_0(W(1,4),W(1,7),W(1,1),GC_1,AMP(2))
         CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
         CALL FFV2_3_2(W(1,4),W(1,7),GC_50,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
         CALL FFV1_0(W(1,6),W(1,5),W(1,1),GC_1,AMP(3))
         CALL FFV2_3_1(W(1,5),W(1,7),GC_50,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
         CALL FFV1_0(W(1,4),W(1,6),W(1,1),GC_1,AMP(4))
         CALL FFV1P0_3(W(1,4),W(1,5),GC_1,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
         CALL FFV1_0(W(1,7),W(1,3),W(1,1),GC_3,AMP(5))
         CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
         CALL FFV1_0(W(1,2),W(1,7),W(1,1),GC_3,AMP(6))
         CALL FFV2_3_3(W(1,4),W(1,5),GC_50,GC_58,MZ,WZ,W(1,7))
         CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
         CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(7))
         CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
         CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(8))
         
         a(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &        -AMP(   6)-AMP(   7)-AMP(   8)
         
      enddo   
      
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))
      
      return
      END
      
c------------------------------------------------------------------------      
          
      subroutine Ato4lU(P,h,a,ttype)
C  
C Generated by MadGraph 5 v. 1.5.5, 2012-11-18                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ e- t~ t  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8) 
      INTEGER    NWAVEFUNCS    
      PARAMETER (NWAVEFUNCS=  7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 P(0:3,2:5),q(0:3)
      integer h,ie,iu
      integer ttype
      complex*16 a(0:5)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J,mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C  
c  lepton spinors and Z polarization vectors
      include 'tensor_zz_born.inc'
      include 'tensor_zz_real.inc'

      double complex lep_loc(6),lem_loc(6),
     &               lup_loc(6),lum_loc(6)
      double complex ae_loc(6), ze_loc(6) 
   
      logical lswitch
      parameter (lswitch=.false.)
C                                                                          
C ----------
C BEGIN CODE
C ----------

      a(:) = 0d0

      ie = sign(1,2-h)
      iu = (-1)**(h+1)

          
      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      do mu = 0,3
         CALL IXXXXX_5(P(0,2   ),ZERO ,+ie,-1,W(1,2   ))       
         CALL OXXXXX_5(P(0,3   ),ZERO ,-ie,+1,W(1,3   ))       
         CALL IXXXXX_5(P(0,4   ),ZERO ,+iu,-1,W(1,4   ))       
         CALL OXXXXX_5(P(0,5   ),ZERO ,-iu,+1,W(1,5   )) 
         
         CALL VCARTX_5(Q(0),zero ,zero, MU,-1,W(1,1   ))

         CALL FFV1P0_3(W(1,2),W(1,3),GC_3,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,4),W(1,6),GC_2,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 1
         CALL FFV1_0(W(1,7),W(1,5),W(1,1),GC_2,AMP(1))
         CALL FFV1_1(W(1,5),W(1,6),GC_2,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 2
         CALL FFV1_0(W(1,4),W(1,7),W(1,1),GC_2,AMP(2))
         CALL FFV2_4_3(W(1,2),W(1,3),GC_50,GC_59,MZ,WZ,W(1,7))
         CALL FFV2_5_2(W(1,4),W(1,7),GC_51,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 3
         CALL FFV1_0(W(1,6),W(1,5),W(1,1),GC_2,AMP(3))
         CALL FFV2_5_1(W(1,5),W(1,7),GC_51,GC_58,ZERO,ZERO,W(1,6))
C     Amplitude(s) for diagram number 4
         CALL FFV1_0(W(1,4),W(1,6),W(1,1),GC_2,AMP(4))
         CALL FFV1P0_3(W(1,4),W(1,5),GC_2,ZERO,ZERO,W(1,6))
         CALL FFV1_2(W(1,2),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 5
         CALL FFV1_0(W(1,7),W(1,3),W(1,1),GC_3,AMP(5))
         CALL FFV1_1(W(1,3),W(1,6),GC_3,ZERO,ZERO,W(1,7))
C     Amplitude(s) for diagram number 6
         CALL FFV1_0(W(1,2),W(1,7),W(1,1),GC_3,AMP(6))
         CALL FFV2_5_3(W(1,4),W(1,5),GC_51,GC_58,MZ,WZ,W(1,7))
         CALL FFV2_4_2(W(1,2),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 7
         CALL FFV1_0(W(1,5),W(1,3),W(1,1),GC_3,AMP(7))
         CALL FFV2_4_1(W(1,3),W(1,7),GC_50,GC_59,ZERO,ZERO,W(1,5))
C     Amplitude(s) for diagram number 8
         CALL FFV1_0(W(1,2),W(1,5),W(1,1),GC_3,AMP(8))
         
         a(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &        -AMP(   6)-AMP(   7)-AMP(   8)
         
         
         
      enddo   
      
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))
      
      return
      END
      

 
c ------------------------------------------------------------	


      subroutine vcartx_5(p,vmass,vwidth,ncart,nsv , vc)
c
c This subroutine computes an effective VECTOR wavefunction for an internal
c vector boson line. The propagator is inlcuded in the Feynman gauge.
c
c input:
c       real    p(0:3)         : four-momentum of vector boson
c       real    vmass          : mass          of vector boson
c       integer ncart = 0,1,2,3: cartesian polarization direction
c                                of vector boson
c       integer nsv  = -1 or 1 : +1 for final, -1 for initial
c
c output:
c       complex vc(6)          : vector wavefunction       epsilon^mu(v)
c     
      implicit none
      double complex vc(6), d
      double precision p(0:3),vmass,vwidth,q2
      integer ncart, mu, nsv

      q2 = p(0)**2-p(1)**2-p(2)**2-p(3)**2
      if (vmass.eq.0d0) then
         d = 1d0/q2
      else
         d = 1d0/dcmplx( q2-vmass**2, vmass*vwidth )
      endif
      do mu = 0,3
         vc(mu+3) = dcmplx(0d0,0d0)
      enddo
      if (ncart.eq.0) then
         vc(3) = d
      else
         vc(ncart+3) = -d
      endif
c
      vc(1) = dcmplx(p(0),p(3))*nsv
      vc(2) = dcmplx(p(1),p(2))*nsv
c
      return
      end
c

